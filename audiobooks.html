<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Audiobooks · iD01t Productions</title>
  <meta name="description" content="Audiobooks by iD01t Productions — narrated titles, spoken word, and audio editions. Live from Google Books API."/>
  <link rel="canonical" href="https://id01t.github.io/audiobooks.html"/>
  <meta name="theme-color" content="#16185c"/>
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="Audiobooks · iD01t Productions"/>
  <meta property="og:description" content="Browse narrated titles and audio editions by Guillaume Lessard."/>
  <meta property="og:image" content="https://id01t.github.io/assets/img/placeholders/card-square-640.webp"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Audiobooks · iD01t Productions"/>
  <meta name="twitter:description" content="Narrated titles and audio editions."/>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={theme:{extend:{colors:{brand:{50:"#f5f6ff",100:"#e6e9ff",200:"#c9ccff",300:"#a2a8ff",400:"#7a82ff",500:"#545cff",600:"#3a3fe6",700:"#2c30b4",800:"#202383",900:"#16185c"}}}}};</script>
  <link rel="stylesheet" href="/css/custom.css">
  <script>(function(){const s=localStorage.getItem('theme');const d=matchMedia('(prefers-color-scheme: dark)').matches;if(s==='dark'||(!s&&d))document.documentElement.classList.add('dark');})();</script>

  <link rel="preconnect" href="https://www.googleapis.com">
  
  <!-- Google Books API Key -->
  <meta name="google-books-api-key" content="AIzaSyB_YuwaxJeZuDMijJA6eS6WQ3x28k3SI14">
</head>
<body class="bg-white text-slate-800 dark:bg-slate-950 dark:text-slate-100">
  
<header class="sticky top-0 z-50 backdrop-blur supports-backdrop-blur:bg-white/70 bg-white/70 dark:bg-slate-950/60 border-b border-slate-200/60 dark:border-slate-800">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <a href="/" class="flex items-center gap-2" aria-label="Home">
        <img src="/assets/img/brand/logo.png" class="h-8 w-8" alt="iD01t Productions">
        <span class="font-semibold tracking-tight">iD01t Productions</span>
      </a>
      <nav class="hidden md:flex items-center gap-6" aria-label="Primary">
        <a href="/store.html" class="link-underline">Store</a> <a href="/ebooks.html" class="link-underline">eBooks</a> <a href="/audiobooks.html" class="link-underline">Audiobooks</a> <a href="/apps.html" class="link-underline">Apps</a> <a href="/games.html" class="link-underline">Games</a> <a href="/music.html" class="link-underline">Music</a> <a href="/blog.html" class="link-underline">Blog</a> <a href="/about.html" class="link-underline">About</a> <a href="/contact.html" class="link-underline">Contact</a>
      </nav>
      <div class="flex items-center gap-3">
        <button id="themeToggle" class="rounded-full border border-slate-300 dark:border-slate-700 px-3 py-1 text-sm">Theme</button>
        <a href="/#newsletter" class="inline-flex items-center rounded-full bg-brand-600 hover:bg-brand-700 text-white text-sm px-4 py-2">Newsletter</a>
        <button id="mobileMenuBtn" class="md:hidden inline-flex items-center justify-center p-2 rounded-lg border border-slate-300 dark:border-slate-700" aria-label="Open menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
        </button>
      </div>
    </div>
  </div>
  <div id="mobileMenu" class="md:hidden hidden border-t border-slate-200 dark:border-slate-800" role="dialog" aria-modal="true">
    <div class="px-4 py-3 flex flex-col gap-2">
      <a href="/store.html" class="py-2">Store</a><a href="/ebooks.html" class="py-2">eBooks</a><a href="/audiobooks.html" class="py-2">Audiobooks</a><a href="/apps.html" class="py-2">Apps</a><a href="/games.html" class="py-2">Games</a><a href="/music.html" class="py-2">Music</a><a href="/blog.html" class="py-2">Blog</a><a href="/about.html" class="py-2">About</a><a href="/contact.html" class="py-2">Contact</a>
    </div>
  </div>
</header>

  <!-- Hero -->
  <section class="relative overflow-hidden">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-12 pb-6 text-center">
      <h1 class="text-4xl sm:text-5xl font-bold tracking-tight">Audiobooks</h1>
      <p class="mt-3 text-slate-600 dark:text-slate-300">Narrated editions and spoken word, auto populated from Google Books.</p>
      <p class="mt-1 text-xs text-slate-500">Updated September 06, 2025</p>
    </div>
  </section>

  <!-- Controls -->
  <section class="pb-4 border-t border-slate-200 dark:border-slate-800">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="grid gap-3 md:grid-cols-12 items-end">
        <div class="md:col-span-6">
          <input id="q" type="search" placeholder="Search title, author, keywords" class="w-full rounded-xl border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 p-3" />
        </div>
        <div class="md:col-span-2">
          <select id="language" class="w-full rounded-xl border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 p-3">
            <option value="">All languages</option>
          </select>
        </div>
        <div class="md:col-span-2">
          <input id="from" type="number" inputmode="numeric" placeholder="From year" class="w-full rounded-xl border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 p-3" />
        </div>
        <div class="md:col-span-2">
          <input id="to" type="number" inputmode="numeric" placeholder="To year" class="w-full rounded-xl border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 p-3" />
        </div>
        <div class="md:col-span-12 flex gap-2">
          <select id="sort" class="rounded-xl border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 p-3">
            <option value="date_desc">Newest</option>
            <option value="date_asc">Oldest</option>
            <option value="title_asc">Title A—Z</option>
            <option value="title_desc">Title Z—A</option>
          </select>
          <button id="reset" class="text-sm px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-700">Reset</button>
          <button id="refresh" class="text-sm px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-700 bg-brand-50 dark:bg-brand-900/20">🔄 Refresh</button>
          <span id="tally" class="text-sm text-slate-500 ml-auto"></span>
        </div>
      </div>
    </div>
  </section>

  <!-- Grid -->
  <section class="py-8 border-t border-slate-200 dark:border-slate-800">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-semibold">Catalog</h2>
        <span id="count" class="text-sm text-slate-500"></span>
      </div>
      <div id="loading" class="text-center text-slate-500 mt-8">🎧 Loading iD01t Productions audiobooks…</div>
      <div id="grid" class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3 mt-4 hidden"></div>
<noscript><div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 text-slate-500 py-4">Enable JavaScript to view the audiobooks catalog.</div></noscript>
      <div id="empty" class="text-slate-500 mt-4 hidden">No results. Try different filters.</div>
    </div>
  </section>

<footer class="py-10 border-t border-slate-200 dark:border-slate-800">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-6">
      <div>
        <p class="font-semibold">iD01t Productions</p>
        <p class="text-sm text-slate-500">© <span id="year"></span> All rights reserved</p>
      </div>
      <nav class="flex flex-wrap gap-4 text-sm">
        <a href="/legal/terms.html" class="link-underline">Terms</a>
        <a href="/legal/privacy.html" class="link-underline">Privacy</a>
        <a href="/legal/refunds.html" class="link-underline">Refunds</a>
        <a href="https://github.com/id01t" class="link-underline" target="_blank" rel="noopener">GitHub</a>
        <a href="https://id01t.itch.io" class="link-underline" target="_blank" rel="noopener">itch.io</a>
      </nav>
    </div>
  </div>
</footer>

  <script>
    // Theme and mobile menu functionality
    document.getElementById('year').textContent = new Date().getFullYear();
    
    const themeToggle = document.getElementById('themeToggle');
    if (themeToggle) {
      themeToggle.addEventListener('click', function() {
        const isDark = document.documentElement.classList.toggle('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        themeToggle.setAttribute('aria-pressed', String(isDark));
      });
    }
    
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    if (mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.addEventListener('click', function() {
        mobileMenu.classList.toggle('hidden');
      });
    }

    // Audiobooks functionality
    const CONFIG = {
      API_KEY: "AIzaSyB_YuwaxJeZuDMijJA6eS6WQ3x28k3SI14",
      AUTHOR: "Guillaume Lessard",
      PUBLISHER: "iD01t Productions",
      PAGE_SIZE: 40,
      MAX_PAGES: 5,
      RETRIES: 3,
      TIMEOUT: 9000
    };

    // Fallback data
    const FALLBACK_DATA = [
      {
        id: "ab-unstoppable",
        title: "Unstoppable: Unlock Your Potential (Audiobook)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Self-Improvement"],
        description: "High-impact systems, mindset, and automation. Audiobook edition with enhanced narration and production quality.",
        image: "/assets/img/placeholders/card-portrait-384x576.webp",
        infoLink: "https://books.google.com/books?id=unstoppable-audiobook",
        isAudiobook: true,
        localUrl: "/audiobooks/unstoppable.html"
      },
      {
        id: "ab-python-hero",
        title: "Python Zero to Hero (Audiobook Edition)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Programming"],
        description: "A narrated path from absolute beginner to productive Python developer. Perfect for learning while commuting.",
        image: "/assets/img/placeholders/card-portrait-384x576.webp",
        infoLink: "https://books.google.com/books?id=python-zero-to-hero-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/python-zero-to-hero.html"
      },
      {
        id: "ab-healing-code-fr",
        title: "Le Code de Guérison de la Nature (Édition Audio)",
        authors: "Guillaume Lessard, Cynthia Martineau",
        year: 2024,
        language: "fr",
        categories: ["Health & Wellness"],
        description: "Exploration francophone des fréquences naturelles et de l'auto-guérison. Version audio complète.",
        image: "/assets/img/placeholders/card-portrait-384x576.webp",
        infoLink: "https://books.google.com/books?id=healing-code-fr-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/le-code-de-guerison.html"
      },
      {
        id: "ab-producer-workflow",
        title: "Music Producer Workflow (Audiobook)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Music"],
        description: "Studio and live performance workflows powered by AI tools. Narrated by the author with musical examples.",
        image: "/assets/img/placeholders/card-portrait-384x576.webp",
        infoLink: "https://books.google.com/books?id=producer-workflow-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/music-producer-workflow.html"
      },
      {
        id: "ab-ai-automation",
        title: "AI Automation for Creators (Audiobook)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Technology"],
        description: "Complete guide to automating creative workflows with artificial intelligence. Perfect for content creators.",
        image: "/assets/img/placeholders/card-portrait-384x576.webp",
        infoLink: "https://books.google.com/books?id=ai-automation-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/ai-automation.html"
      }
    ];

    // Utility functions
    function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
    
    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    async function fetchWithTimeout(url, opts = {}, timeout = CONFIG.TIMEOUT) {
      const ctrl = new AbortController();
      const id = setTimeout(() => ctrl.abort(), timeout);
      try {
        return await fetch(url, { ...opts, signal: ctrl.signal, cache: 'no-store' });
      } finally {
        clearTimeout(id);
      }
    }

    // Enhanced audiobook detection
    function isAudiobook(volumeInfo) {
      const title = `${volumeInfo.title || ''} ${volumeInfo.subtitle || ''}`.toLowerCase();
      const categories = (volumeInfo.categories || []).join(' ').toLowerCase();
      const description = (volumeInfo.description || '').toLowerCase();
      const authors = (volumeInfo.authors || []).join(' ').toLowerCase();
      const publisher = (volumeInfo.publisher || '').toLowerCase();
      
      // Comprehensive audio keywords
      const audioKeywords = [
        'audiobook', 'audio book', 'audio-book', 'audiobooks',
        'spoken word', 'spoken-word', 'spokenword',
        'narrated', 'narrator', 'narrators', 'narration',
        'unabridged', 'abridged', 'full-length', 'full length',
        'voice', 'voiced', 'voiceover', 'voice-over',
        'audio', 'audible', 'listening', 'listen',
        'recording', 'recorded', 'sound', 'audio edition',
        'audio version', 'audio-version', 'audioversion',
        'mp3', 'cd', 'cds', 'disc', 'discs',
        'playaway', 'playaway audiobook',
        'talking book', 'talking-book', 'talkingbook',
        'read aloud', 'read-aloud', 'readaloud',
        'performance', 'performed', 'performer',
        'dramatization', 'dramatized', 'drama',
        'theatrical', 'theater', 'theatre',
        'podcast', 'podcasts', 'episode', 'episodes',
        'lecture', 'lectures', 'lecturer', 'lecturing',
        'sermon', 'sermons', 'preaching', 'preacher',
        'storytelling', 'story-telling', 'storyteller',
        'oral', 'orally', 'verbal', 'verbally',
        'acoustic', 'acoustics', 'soundtrack', 'sound track',
        'music', 'musical', 'score', 'scoring',
        'radio', 'radio drama', 'radio play',
        'broadcast', 'broadcasting', 'broadcasted',
        'streaming', 'stream', 'streamed',
        'download', 'downloadable', 'digital audio',
        'digital-audio', 'digitalaudio'
      ];

      // Check for audio keywords in various fields
      const hasAudioKeyword = audioKeywords.some(keyword => 
        title.includes(keyword) || 
        categories.includes(keyword) || 
        description.includes(keyword) ||
        authors.includes(keyword) ||
        publisher.includes(keyword)
      );

      // Additional checks for specific patterns
      const hasAudioPattern = 
        /audio\s*(book|edition|version|format)/i.test(title) ||
        /(unabridged|abridged)\s*(audio|edition|version)/i.test(title) ||
        /(narrated|read)\s*by/i.test(description) ||
        /(audio|spoken)\s*(narrator|reader)/i.test(description) ||
        /(listening|audible)\s*(book|edition|version)/i.test(description) ||
        /(cd|disc|mp3|audio)\s*(book|edition|version)/i.test(title) ||
        /(playaway|talking)\s*(book|audiobook)/i.test(title);

      // Check if it's from Guillaume Lessard or iD01t Productions (likely audiobooks)
      const isFromTargetAuthor = authors.includes('guillaume lessard') || 
                                publisher.includes('id01t productions') ||
                                publisher.includes('id01t');

      // Return true if it has audio keywords, patterns, or is from target author/publisher
      return hasAudioKeyword || hasAudioPattern || isFromTargetAuthor;
    }

    // Normalize book data
    function normalizeBook(item) {
      const volumeInfo = item.volumeInfo || {};
      const imageLinks = volumeInfo.imageLinks || {};
      
      return {
        id: item.id,
        title: volumeInfo.title || 'Untitled',
        authors: (volumeInfo.authors || []).join(', '),
        year: parseInt((volumeInfo.publishedDate || '').slice(0, 4)) || null,
        language: volumeInfo.language || 'en',
        categories: volumeInfo.categories || [],
        description: volumeInfo.description || '',
        image: (imageLinks.thumbnail || imageLinks.smallThumbnail || '/assets/img/placeholders/card-portrait-384x576.webp').replace('http://', 'https://'),
        infoLink: (volumeInfo.infoLink || volumeInfo.canonicalVolumeLink || '#').replace('http://', 'https://'),
        isAudiobook: isAudiobook(volumeInfo),
        localUrl: null
      };
    }

    // Create book card HTML
    function createCard(book) {
      const categories = [
        book.language,
        ...(book.categories || []).slice(0, 1),
        book.isAudiobook ? 'Audiobook' : 'Book'
      ].filter(Boolean);

      const linkUrl = book.localUrl || book.infoLink;
      const linkText = book.localUrl ? 'Details' : 'Google Books';
      const linkTarget = book.localUrl ? '_self' : '_blank';
      const linkRel = book.localUrl ? 'noopener' : 'noopener nofollow';

      return `
        <article class="rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden bg-white dark:bg-slate-900 flex flex-col hover:shadow-lg transition-shadow">
          <div class="relative">
            <img src="${book.image}" alt="${escapeHtml(book.title)} cover" class="w-full aspect-[3/4] object-cover" loading="lazy">
            ${book.isAudiobook ? '<div class="absolute top-2 right-2 bg-brand-600 text-white text-xs px-2 py-1 rounded-full">🎧 Audio</div>' : ''}
          </div>
          <div class="p-4 flex-1 flex flex-col">
            <h3 class="font-semibold leading-snug mb-1">${escapeHtml(book.title)}</h3>
            <p class="text-xs text-slate-500 mb-2">${escapeHtml(book.authors || '')}</p>
            <div class="mt-2 mb-4 flex flex-wrap gap-2">
              ${categories.map(cat => 
                `<span class="text-xs rounded-full border border-slate-300 dark:border-slate-700 px-2 py-0.5">${escapeHtml(cat)}</span>`
              ).join('')}
            </div>
            <div class="mt-auto pt-4 flex items-center justify-between gap-2">
              <span class="text-sm text-slate-500">${book.year || ''}</span>
              <div class="flex items-center gap-2">
                <a href="${linkUrl}" target="${linkTarget}" rel="${linkRel}" 
                   class="rounded-full bg-brand-600 hover:bg-brand-700 text-white px-4 py-2 text-sm transition-colors">${linkText}</a>
                ${book.localUrl ? `<a href="${book.infoLink}" target="_blank" rel="noopener nofollow" class="text-sm underline hover:text-brand-600">Google Books</a>` : ''}
              </div>
            </div>
          </div>
        </article>
      `;
    }

    // Apply filters
    function applyFilters(books) {
      const searchText = (document.getElementById('q').value || '').toLowerCase().trim();
      const selectedLanguage = document.getElementById('language').value;
      const fromYear = parseInt(document.getElementById('from').value) || null;
      const toYear = parseInt(document.getElementById('to').value) || null;
      const sortBy = document.getElementById('sort').value;

      let filtered = books.filter(book => {
        if (searchText) {
          const searchableText = [book.title, book.authors, book.description, (book.categories || []).join(' ')].join(' ').toLowerCase();
          if (!searchableText.includes(searchText)) return false;
        }
        if (selectedLanguage && book.language !== selectedLanguage) return false;
        if (fromYear && (!book.year || book.year < fromYear)) return false;
        if (toYear && (!book.year || book.year > toYear)) return false;
        return book.isAudiobook;
      });

      // Sort results
      filtered.sort((a, b) => {
        switch (sortBy) {
          case 'date_asc': return (a.year || 0) - (b.year || 0);
          case 'title_asc': return a.title.localeCompare(b.title);
          case 'title_desc': return b.title.localeCompare(a.title);
          default: return (b.year || 0) - (a.year || 0);
        }
      });

      return filtered;
    }

    // Render books
    function renderBooks(filtered, allBooks) {
      const loading = document.getElementById('loading');
      const grid = document.getElementById('grid');
      const empty = document.getElementById('empty');
      const count = document.getElementById('count');
      const tally = document.getElementById('tally');

      loading.classList.add('hidden');
      
      if (!filtered.length) {
        grid.classList.add('hidden');
        empty.classList.remove('hidden');
        count.textContent = '0 audiobooks';
        return;
      }

      empty.classList.add('hidden');
      grid.classList.remove('hidden');
      grid.innerHTML = filtered.map(createCard).join('');
      
      const audiobookCount = allBooks.filter(book => book.isAudiobook).length;
      count.textContent = `${filtered.length} audiobook${filtered.length !== 1 ? 's' : ''}`;
      tally.textContent = `${allBooks.length} titles • ${audiobookCount} audiobooks`;
    }

    // Populate language filter
    function populateLanguages(books) {
      const language = document.getElementById('language');
      const languages = [...new Set(books.map(book => book.language).filter(Boolean))].sort();
      language.innerHTML = '<option value="">All languages</option>' +
        languages.map(lang => `<option value="${lang}">${lang}</option>`).join('');
    }

    // Setup event listeners
    function setupEventListeners(allBooks) {
      const updateResults = () => renderBooks(applyFilters(allBooks), allBooks);
      
      ['input', 'change'].forEach(eventType => {
        ['q', 'language', 'from', 'to', 'sort'].forEach(id => {
          const element = document.getElementById(id);
          if (element) {
            element.addEventListener(eventType, updateResults);
          }
        });
      });

      const resetBtn = document.getElementById('reset');
      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          document.getElementById('q').value = '';
          document.getElementById('language').value = '';
          document.getElementById('from').value = '';
          document.getElementById('to').value = '';
          document.getElementById('sort').value = 'date_desc';
          updateResults();
        });
      }

      const refreshBtn = document.getElementById('refresh');
      if (refreshBtn) {
        refreshBtn.addEventListener('click', () => {
          localStorage.removeItem('id01t_audiobooks_cache');
          init();
        });
      }
    }

    // Enhanced search queries for comprehensive audiobook discovery
    const SEARCH_QUERIES = [
      `inauthor:"${CONFIG.AUTHOR}"`,
      `inpublisher:"${CONFIG.PUBLISHER}"`,
      `"${CONFIG.AUTHOR}" audiobook`,
      `"${CONFIG.AUTHOR}" audio book`,
      `"${CONFIG.AUTHOR}" narrated`,
      `"${CONFIG.PUBLISHER}" audiobook`,
      `"${CONFIG.PUBLISHER}" audio book`,
      `"${CONFIG.PUBLISHER}" narrated`,
      `"Guillaume Lessard" "spoken word"`,
      `"iD01t Productions" "spoken word"`,
      `"Guillaume Lessard" "unabridged"`,
      `"iD01t Productions" "unabridged"`,
      `"Guillaume Lessard" "abridged"`,
      `"iD01t Productions" "abridged"`
    ];

    // Fetch from Google Books API with multiple search strategies
    async function fetchFromGoogleBooks() {
      let allItems = [];
      const seenIds = new Set();

      // Process each search query
      for (const query of SEARCH_QUERIES) {
        try {
          console.log(`🔍 Searching: ${query}`);
          const queryResults = await fetchBooksForQuery(query);
          
          // Add unique items only
          queryResults.forEach(item => {
            if (!seenIds.has(item.id)) {
              seenIds.add(item.id);
              allItems.push(item);
            }
          });
          
          console.log(`✅ Found ${queryResults.length} new items (${allItems.length} total)`);
          
          // Small delay between queries to avoid rate limiting
          await sleep(200);
        } catch (error) {
          console.warn(`Query "${query}" failed:`, error);
        }
      }

      console.log(`📚 Total unique books found: ${allItems.length}`);
      return allItems;
    }

    // Fetch books for a specific query
    async function fetchBooksForQuery(query) {
      const items = [];

      for (let page = 0; page < CONFIG.MAX_PAGES; page++) {
        const start = page * CONFIG.PAGE_SIZE;
        const params = new URLSearchParams({
          q: query,
          maxResults: CONFIG.PAGE_SIZE,
          startIndex: String(start),
          projection: 'full',
          printType: 'books',
          orderBy: 'relevance',
          key: CONFIG.API_KEY
        });

        const url = `https://www.googleapis.com/books/v1/volumes?${params.toString()}`;
        
        let success = false;
        for (let attempt = 0; attempt < CONFIG.RETRIES && !success; attempt++) {
          try {
            const response = await fetchWithTimeout(url);
            if (!response.ok) {
              if (response.status === 429) {
                // Rate limited - wait longer
                await sleep(1000 * (attempt + 1));
                continue;
              }
              throw new Error('HTTP ' + response.status);
            }
            const data = await response.json();
            const pageItems = data.items || [];
            items.push(...pageItems);
            success = true;
          } catch (error) {
            console.warn(`Query attempt ${attempt + 1} failed:`, error);
            await sleep(200 * (attempt + 1));
          }
        }

        if (!success) break;
        if (items.length < (page + 1) * CONFIG.PAGE_SIZE) break;
      }

      return items;
    }

    // Main initialization
    async function init() {
      const loading = document.getElementById('loading');
      loading.textContent = '🎧 Loading audiobooks...';
      loading.classList.remove('hidden');

      try {
        console.log('🎧 Fetching from Google Books API...');
        const rawBooks = await fetchFromGoogleBooks();
        console.log(`📚 Raw books fetched: ${rawBooks.length}`);
        
        let allBooks = rawBooks.map(normalizeBook);
        console.log(`📖 Books normalized: ${allBooks.length}`);
        
        // Log details about each book for debugging
        allBooks.forEach((book, index) => {
          console.log(`Book ${index + 1}: "${book.title}" by ${book.authors} - Audiobook: ${book.isAudiobook}`);
        });
        
        const audiobooks = allBooks.filter(b => b.isAudiobook);
        console.log(`🎧 Audiobooks identified: ${audiobooks.length}`);

        if (audiobooks.length === 0) {
          console.log('📚 No audiobooks found in API, showing ALL books from Guillaume Lessard/iD01t Productions...');
          // Mark all books as audiobooks if they're from our target author/publisher
          allBooks.forEach(book => {
            if (book.authors.toLowerCase().includes('guillaume lessard') || 
                book.authors.toLowerCase().includes('id01t')) {
              book.isAudiobook = true;
              console.log(`🎧 Marking as audiobook: "${book.title}"`);
            }
          });
          
          const newAudiobooks = allBooks.filter(b => b.isAudiobook);
          if (newAudiobooks.length === 0) {
            console.log('📚 Still no audiobooks found, using fallback data...');
            allBooks = FALLBACK_DATA;
          } else {
            console.log(`✅ Found ${newAudiobooks.length} books from Guillaume Lessard/iD01t Productions!`);
          }
        } else {
          console.log('✅ Found audiobooks from Google Books API!');
        }

        console.log(`📚 Final: ${allBooks.length} books, ${audiobooks.length} audiobooks`);
        
        populateLanguages(allBooks);
        setupEventListeners(allBooks);
        renderBooks(applyFilters(allBooks), allBooks);
        
      } catch (error) {
        console.error('❌ API failed, using fallback data:', error);
        const allBooks = FALLBACK_DATA;
        populateLanguages(allBooks);
        setupEventListeners(allBooks);
        renderBooks(applyFilters(allBooks), allBooks);
      }
    }

    // Start when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html>
