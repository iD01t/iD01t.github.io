<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Professional Audiobooks - Programming, AI, Chess & More Â· iD01t Productions</title>
  <meta name="description" content="Discover our premium collection of audiobooks covering programming, AI, chess mastery, business development, and personal growth. Professionally narrated by Guillaume Lessard with HD cover art and seamless purchasing experience."/>
  <link rel="canonical" href="https://id01t.store/audiobooks.html"/>
  
  <!-- SEO & Social Media -->
  <meta name="keywords" content="audiobooks, programming audiobooks, AI audiobooks, chess audiobooks, technical audiobooks, Guillaume Lessard, iD01t Productions"/>
  <meta name="author" content="Guillaume Lessard"/>
  <meta name="robots" content="index, follow"/>
  <meta name="theme-color" content="#16185c"/>
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="iD01t Productions"/>
  <meta property="og:title" content="Professional Audiobooks - Programming, AI, Chess & More"/>
  <meta property="og:description" content="Premium collection of professionally narrated audiobooks covering programming, AI, chess mastery, and business development by Guillaume Lessard."/>
  <meta property="og:url" content="https://id01t.store/audiobooks.html"/>
  <meta property="og:image" content="https://id01t.store/assets/img/brand/audiobooks-og.webp"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
  <meta property="og:image:alt" content="iD01t Productions Professional Audiobooks Collection"/>
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:site" content="@id01t"/>
  <meta name="twitter:creator" content="@id01t"/>
  <meta name="twitter:title" content="Professional Audiobooks - Programming, AI, Chess & More"/>
  <meta name="twitter:description" content="Premium audiobooks by Guillaume Lessard covering programming, AI, chess, and business development."/>
  <meta name="twitter:image" content="https://id01t.store/assets/img/brand/audiobooks-og.webp"/>
  
  <!-- Additional SEO -->
  <meta name="format-detection" content="telephone=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Professional Audiobooks by iD01t Productions",
    "description": "Premium audiobooks covering programming, AI, chess mastery, and business development",
    "url": "https://id01t.store/audiobooks.html",
    "publisher": {
      "@type": "Organization",
      "name": "iD01t Productions",
      "url": "https://id01t.store",
      "logo": "https://id01t.store/assets/img/brand/logo.svg"
    },
    "author": {
      "@type": "Person",
      "name": "Guillaume Lessard",
      "url": "https://id01t.store/about.html"
    },
    "mainEntity": {
      "@type": "ItemList",
      "name": "Professional Audiobooks Collection",
      "numberOfItems": "200+"
    }
  }
  </script>

  <!-- Styles -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={theme:{extend:{colors:{brand:{50:"#f5f6ff",100:"#e6e9ff",200:"#c9ccff",300:"#a2a8ff",400:"#7a82ff",500:"#545cff",600:"#3a3fe6",700:"#2c30b4",800:"#202383",900:"#16185c"}}}}};</script>
  
  <!-- Custom Styles -->
  <style>
    .focus-ring:focus { 
      outline: none; 
      box-shadow: 0 0 0 2px #2aa7ff, 0 0 0 4px rgba(42, 167, 255, 0.1); 
    }
    .dark .focus-ring:focus { 
      box-shadow: 0 0 0 2px #2aa7ff, 0 0 0 4px rgba(42, 167, 255, 0.2); 
    }
    .link-underline:hover { 
      text-decoration: underline; 
      text-underline-offset: 4px; 
      text-decoration-thickness: 2px; 
      text-decoration-color: rgba(42, 167, 255, 0.6); 
      transition: all 0.2s; 
    }
    .card-hover:hover { 
      transform: scale(1.02) translateY(-4px); 
      transition: transform 0.3s ease; 
    }
    .line-clamp-2 { 
      display: -webkit-box; 
      -webkit-line-clamp: 2; 
      line-clamp: 2; 
      -webkit-box-orient: vertical; 
      overflow: hidden; 
    }
    .line-clamp-3 { 
      display: -webkit-box; 
      -webkit-line-clamp: 3; 
      line-clamp: 3; 
      -webkit-box-orient: vertical; 
      overflow: hidden; 
    }
    .intersection-animate { opacity: 0; transform: translateY(30px); transition: all 0.6s ease-out; }
    .intersection-animate.visible { opacity: 1; transform: translateY(0); }
    .glass-effect { backdrop-filter: blur(16px); background: rgba(255, 255, 255, 0.8); }
    .dark .glass-effect { background: rgba(15, 23, 42, 0.8); }
  </style>

  <!-- Preconnects for Performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://www.googleapis.com"/>
  <link rel="dns-prefetch" href="//books.google.com"/>
  <link rel="dns-prefetch" href="//play.google.com"/>
</head>

<body class="bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-100 antialiased">

<!-- Header -->
<header class="sticky top-0 z-50 glass-effect border-b border-slate-200/50 dark:border-slate-800/50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-3 focus-ring rounded-lg p-1" aria-label="iD01t Productions home">
        <img src="/assets/img/brand/logo.svg" alt="iD01t Productions logo" class="h-8 w-8" />
        <span class="font-bold text-lg bg-gradient-to-r from-brand-600 to-brand-800 bg-clip-text text-transparent">iD01t Productions</span>
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden md:flex items-center gap-8" aria-label="Main navigation">
        <a href="/index.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">Home</a>
        <a href="/store.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">Store</a>
        <a href="/apps.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">Apps</a>
        <a href="/ebooks.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">eBooks</a>
        <a href="/audiobooks.html" class="text-brand-600 dark:text-brand-400 font-semibold focus-ring rounded px-2 py-1" aria-current="page">Audiobooks</a>
        <a href="/games.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">Games</a>
        <a href="/music.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">Music</a>
        <a href="/blog.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">Blog</a>
        <a href="/about.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">About</a>
        <a href="/contact.html" class="text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded px-2 py-1">Contact</a>
      </nav>

      <!-- Header Actions -->
      <div class="flex items-center gap-3">
        <!-- Theme Toggle -->
        <button id="themeToggle" class="inline-flex items-center gap-2 rounded-full border border-slate-300 dark:border-slate-600 px-3 py-1.5 text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors focus-ring" aria-label="Toggle theme">
          <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>
          <span class="theme-text">Dark</span>
        </button>
        
        <!-- Newsletter CTA -->
        <a href="/#newsletter" class="hidden sm:inline-flex items-center gap-2 rounded-full bg-brand-600 hover:bg-brand-700 text-white text-sm font-medium px-4 py-2 transition-colors focus-ring focus:ring-offset-2">
          <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
          </svg>
          Newsletter
        </a>

        <!-- Mobile Menu Button -->
        <button id="mobileMenuBtn" class="md:hidden inline-flex items-center justify-center p-2 rounded-lg border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors focus-ring" aria-label="Open menu" aria-expanded="false">
          <svg id="menuIcon" class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg id="closeIcon" class="h-5 w-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobileMenu" class="md:hidden hidden border-t border-slate-200/50 dark:border-slate-800/50 glass-effect" role="dialog" aria-modal="true" aria-label="Mobile navigation">
    <div class="px-4 py-6 space-y-4">
      <a href="/index.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">Home</a>
      <a href="/store.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">Store</a>
      <a href="/apps.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">Apps</a>
      <a href="/ebooks.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">eBooks</a>
      <a href="/audiobooks.html" class="block py-2 text-brand-600 dark:text-brand-400 font-semibold focus-ring rounded" aria-current="page">Audiobooks</a>
      <a href="/games.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">Games</a>
      <a href="/music.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">Music</a>
      <a href="/blog.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">Blog</a>
      <a href="/about.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">About</a>
      <a href="/contact.html" class="block py-2 text-slate-700 dark:text-slate-300 hover:text-brand-600 dark:hover:text-brand-400 font-medium transition-colors focus-ring rounded">Contact</a>
      <div class="pt-4 border-t border-slate-200 dark:border-slate-800">
        <a href="/#newsletter" class="inline-flex items-center gap-2 rounded-full bg-brand-600 hover:bg-brand-700 text-white text-sm font-medium px-4 py-2 transition-colors focus-ring">
          <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
          </svg>
          Newsletter
        </a>
      </div>
    </div>
  </div>
</header>

<!-- Hero Section -->
<section class="relative bg-gradient-to-br from-brand-50 via-white to-slate-50 dark:from-slate-900 dark:via-slate-950 dark:to-slate-900 py-24 intersection-animate">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <!-- Badge -->
    <div class="inline-flex items-center gap-2 px-4 py-2 bg-brand-100 dark:bg-brand-900/50 text-brand-700 dark:text-brand-300 rounded-full text-sm font-medium mb-8">
      <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 14.142M9 9a3 3 0 106 0v5a3 3 0 11-6 0V9z"></path>
      </svg>
      Premium Audiobook Collection
    </div>

    <!-- Main Heading -->
    <h1 class="text-5xl sm:text-6xl lg:text-7xl font-black text-slate-900 dark:text-white mb-8 leading-none">
      Professional
      <span class="bg-gradient-to-r from-brand-600 via-brand-500 to-brand-600 bg-clip-text text-transparent">Audiobooks</span>
    </h1>

    <!-- Description -->
    <p class="text-xl text-slate-600 dark:text-slate-300 mb-12 max-w-3xl mx-auto leading-relaxed">
      Discover our premium collection of <strong>200+ audiobooks</strong> covering programming, AI, chess mastery, business development, and personal growth. Professionally narrated by Guillaume Lessard with crystal-clear audio quality.
    </p>

    <!-- Stats -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-8 max-w-2xl mx-auto">
      <div class="text-center">
        <div class="text-3xl font-bold text-brand-600 dark:text-brand-400" id="totalCount">200+</div>
        <div class="text-sm text-slate-500 dark:text-slate-400">Audiobooks</div>
      </div>
      <div class="text-center">
        <div class="text-3xl font-bold text-brand-600 dark:text-brand-400">7</div>
        <div class="text-sm text-slate-500 dark:text-slate-400">Categories</div>
      </div>
      <div class="text-center">
        <div class="text-3xl font-bold text-brand-600 dark:text-brand-400">HD</div>
        <div class="text-sm text-slate-500 dark:text-slate-400">Audio Quality</div>
      </div>
      <div class="text-center">
        <div class="text-3xl font-bold text-brand-600 dark:text-brand-400">24/7</div>
        <div class="text-sm text-slate-500 dark:text-slate-400">Availability</div>
      </div>
    </div>
  </div>

  <!-- Background Elements -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute -top-40 -right-40 w-80 h-80 bg-brand-200/20 dark:bg-brand-800/20 rounded-full blur-3xl"></div>
    <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-brand-300/20 dark:bg-brand-700/20 rounded-full blur-3xl"></div>
  </div>
</section>

<!-- Search & Filter Controls -->
<section class="bg-white dark:bg-slate-900 py-16 intersection-animate border-b border-slate-200 dark:border-slate-800">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-6 mb-12">
      <div>
        <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Browse Audiobooks</h2>
        <p class="text-slate-600 dark:text-slate-300 mt-2">
          <span id="resultsCount">200+</span> professional audiobooks available
        </p>
      </div>
      
      <!-- Quick Filters -->
      <div class="flex flex-wrap gap-2">
        <button class="category-filter-btn px-4 py-2 text-sm font-medium bg-brand-100 dark:bg-brand-900 text-brand-700 dark:text-brand-300 rounded-full hover:bg-brand-200 dark:hover:bg-brand-800 transition-colors focus-ring" data-category="">All</button>
        <button class="category-filter-btn px-4 py-2 text-sm font-medium bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors focus-ring" data-category="programming">Programming</button>
        <button class="category-filter-btn px-4 py-2 text-sm font-medium bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors focus-ring" data-category="ai">AI & ML</button>
        <button class="category-filter-btn px-4 py-2 text-sm font-medium bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors focus-ring" data-category="chess">Chess</button>
        <button class="category-filter-btn px-4 py-2 text-sm font-medium bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors focus-ring" data-category="business">Business</button>
      </div>
    </div>

    <!-- Search & Sort Controls -->
    <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
      <!-- Search Input -->
      <div class="md:col-span-2 lg:col-span-2">
        <div class="relative">
          <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <input 
            type="search" 
            id="searchInput"
            placeholder="Search audiobooks by title, author, or topic..." 
            class="w-full pl-10 pr-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-colors"
          />
        </div>
      </div>

      <!-- Category Filter -->
      <div>
        <select id="categoryFilter" class="w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-colors">
          <option value="">All Categories</option>
          <option value="programming">Programming</option>
          <option value="ai">AI & Machine Learning</option>
          <option value="chess">Chess Strategy</option>
          <option value="music">Music Production</option>
          <option value="business">Business & Finance</option>
          <option value="personal">Personal Growth</option>
          <option value="science">Science & Tech</option>
        </select>
      </div>

      <!-- Sort Order -->
      <div>
        <select id="sortOrder" class="w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-colors">
          <option value="newest">Newest First</option>
          <option value="title">Title A-Z</option>
          <option value="popular">Most Popular</option>
        </select>
      </div>
    </div>
  </div>
</section>

<!-- Audiobooks Grid -->
<section class="bg-slate-50 dark:bg-slate-950 py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Loading State -->
    <div id="loadingState" class="text-center py-20">
      <div class="inline-flex items-center gap-3 text-slate-600 dark:text-slate-400">
        <svg class="animate-spin h-6 w-6" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <span class="text-lg font-medium">Loading premium audiobooks...</span>
      </div>
    </div>

    <!-- Audiobooks Grid -->
    <div id="audiobooksGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 hidden"></div>

    <!-- Load More Button -->
    <div class="text-center mt-16">
      <button id="loadMoreBtn" class="hidden inline-flex items-center gap-2 px-8 py-3 bg-brand-600 hover:bg-brand-700 text-white font-medium rounded-full transition-colors focus-ring">
        <span>Load More Audiobooks</span>
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
      </button>
    </div>
  </div>
</section>
      
      <noscript>
        <div class="text-center py-20">
          <p class="text-slate-600 dark:text-slate-400">Please enable JavaScript to view the audiobooks catalog.</p>
        </div>
      </noscript>
      
      <div id="empty" class="text-center py-20 hidden">
        <p class="text-slate-600 dark:text-slate-400 mb-4">No audiobooks found.</p>
        <button id="reset" class="text-blue-600 hover:text-blue-700">Reset filters</button>
      </div>
    </div>
  </section>

<!-- Spacer to ensure footer visibility on short viewports -->
<div class="h-20"></div>

<!-- ==================== FOOTER ==================== -->
<footer class="mt-24 bg-slate-900 text-slate-300 py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid md:grid-cols-4 gap-12">
    <div class="space-y-4">
      <a href="/" class="flex items-center gap-2 focus-ring" aria-label="iD01t Productions home">
        <img src="/assets/img/brand/logo.svg" alt="iD01t Productions logo" class="h-8 w-8" />
        <span class="font-semibold text-lg text-white">iD01t Productions</span>
      </a>
      <p class="text-sm">Professional digital tools and creative content for developers, creators, and innovators worldwide.</p>
    </div>

    <div>
      <h3 class="font-semibold text-white mb-4">Products</h3>
      <ul class="space-y-2 text-sm">
        <li><a href="/apps.html" class="hover:text-white transition-colors focus-ring rounded">Windows Apps</a></li>
        <li><a href="/ebooks.html" class="hover:text-white transition-colors focus-ring rounded">Technical eBooks</a></li>
        <li><a href="/audiobooks.html" class="hover:text-white transition-colors focus-ring rounded">Audiobooks</a></li>
        <li><a href="/games.html" class="hover:text-white transition-colors focus-ring rounded">Online Games</a></li>
        <li><a href="/music.html" class="hover:text-white transition-colors focus-ring rounded">Original Music</a></li>
      </ul>
    </div>

    <div>
      <h3 class="font-semibold text-white mb-4">Resources</h3>
      <ul class="space-y-2 text-sm">
        <li><a href="/blog.html" class="hover:text-white transition-colors focus-ring rounded">Blog & Guides</a></li>
        <li><a href="/store.html" class="hover:text-white transition-colors focus-ring rounded">Store</a></li>
        <li><a href="/about.html" class="hover:text-white transition-colors focus-ring rounded">About Us</a></li>
        <li><a href="/contact.html" class="hover:text-white transition-colors focus-ring rounded">Contact</a></li>
        <li><a href="/#newsletter" class="hover:text-white transition-colors focus-ring rounded">Newsletter</a></li>
      </ul>
    </div>

    <div>
      <h3 class="font-semibold text-white mb-4">Legal</h3>
      <ul class="space-y-2 text-sm">
        <li><a href="/legal/terms.html" class="hover:text-white transition-colors focus-ring rounded">Terms of Service</a></li>
        <li><a href="/legal/privacy.html" class="hover:text-white transition-colors focus-ring rounded">Privacy Policy</a></li>
        <li><a href="/legal/refunds.html" class="hover:text-white transition-colors focus-ring rounded">Refund Policy</a></li>
      </ul>
    </div>
  </div>

  <!-- Bottom -->
  <div class="pt-8 border-t border-slate-800 mt-12 px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row items-center justify-between gap-4 text-sm">
    <p class="text-slate-400">Â© <span id="year"></span> iD01t Productions. All rights reserved.</p>
    <div class="flex items-center gap-6">
      <span class="flex items-center gap-2"><div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div><span class="text-slate-400">All systems operational</span></span>
      <a href="/legal/terms.html" class="hover:text-white transition-colors focus-ring rounded">Terms</a>
      <a href="/legal/privacy.html" class="hover:text-white transition-colors focus-ring rounded">Privacy</a>
    </div>
  </div>
</footer>

  <script>
    // Global variables
    let allAudiobooks = [];
    let filteredAudiobooks = [];
    let currentPage = 0;
    const itemsPerPage = 16;

    // Theme and mobile menu functionality
    document.getElementById('year').textContent = new Date().getFullYear();
    
    // Theme functionality
    function initTheme() {
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const isDark = savedTheme === 'dark' || (!savedTheme && prefersDark);
      
      if (isDark) {
        document.documentElement.classList.add('dark');
        document.querySelector('.theme-text').textContent = 'Light';
      } else {
        document.documentElement.classList.remove('dark');
        document.querySelector('.theme-text').textContent = 'Dark';
      }
      
      return isDark;
    }
    
    // Initialize theme on page load
    const currentTheme = initTheme();
    
    // Theme toggle functionality
    const themeToggle = document.getElementById('themeToggle');
    if (themeToggle) {
      themeToggle.addEventListener('click', function() {
        const isDark = document.documentElement.classList.toggle('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        document.querySelector('.theme-text').textContent = isDark ? 'Light' : 'Dark';
      });
    }
    
    // Mobile menu functionality
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const menuIcon = document.getElementById('menuIcon');
    const closeIcon = document.getElementById('closeIcon');
    
    if (mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.addEventListener('click', () => {
        const isOpen = mobileMenu.classList.toggle('hidden');
        mobileMenuBtn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
        if (menuIcon && closeIcon) {
          menuIcon.classList.toggle('hidden', isOpen);
          closeIcon.classList.toggle('hidden', !isOpen);
        }
        if (isOpen) {
          const firstLink = mobileMenu.querySelector('a');
          if (firstLink) firstLink.focus();
        } else {
          mobileMenuBtn.focus();
        }
      });
    }

    // Intersection animations
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });
    document.querySelectorAll('.intersection-animate').forEach(el => observer.observe(el));

    // Audiobooks functionality
    const CONFIG = {
      API_KEY: "AIzaSyB_YuwaxJeZuDMijJA6eS6WQ3x28k3SI14",
      AUTHOR: "Guillaume Lessard",
      PUBLISHER: "iD01t Productions",
      PAGE_SIZE: 40,
      MAX_PAGES: 5,
      RETRIES: 3,
      TIMEOUT: 9000
    };

    // Fallback data with local image paths
    const FALLBACK_DATA = [
      {
        id: "ab-unstoppable",
        title: "Unstoppable: Unlock Your Potential (Audiobook)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Self-Improvement"],
        description: "High-impact systems, mindset, and automation. Audiobook edition with enhanced narration and production quality.",
        image: null, // Will use local image system
        infoLink: "https://books.google.com/books?id=unstoppable-audiobook",
        isAudiobook: true,
        localUrl: "/audiobooks/unstoppable.html",
        audiobook_number: "001"
      },
      {
        id: "ab-python-hero",
        title: "Python Zero to Hero (Audiobook Edition)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Programming"],
        description: "A narrated path from absolute beginner to productive Python developer. Perfect for learning while commuting.",
        image: null, // Will use local image system
        infoLink: "https://books.google.com/books?id=python-zero-to-hero-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/python-zero-to-hero.html",
        audiobook_number: "002"
      },
      {
        id: "ab-healing-code-fr",
        title: "Le Code de GuÃ©rison de la Nature (Ãdition Audio)",
        authors: "Guillaume Lessard, Cynthia Martineau",
        year: 2024,
        language: "fr",
        categories: ["Health & Wellness"],
        description: "Exploration francophone des frÃ©quences naturelles et de l'auto-guÃ©rison. Version audio complÃ¨te.",
        image: null, // Will use local image system
        infoLink: "https://books.google.com/books?id=healing-code-fr-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/le-code-de-guerison.html",
        audiobook_number: "003"
      },
      {
        id: "ab-producer-workflow",
        title: "Music Producer Workflow (Audiobook)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Music"],
        description: "Studio and live performance workflows powered by AI tools. Narrated by the author with musical examples.",
        image: null, // Will use local image system
        infoLink: "https://books.google.com/books?id=producer-workflow-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/music-producer-workflow.html",
        audiobook_number: "004"
      },
      {
        id: "ab-ai-automation",
        title: "AI Automation for Creators (Audiobook)",
        authors: "Guillaume Lessard",
        year: 2025,
        language: "en",
        categories: ["Technology"],
        description: "Complete guide to automating creative workflows with artificial intelligence. Perfect for content creators.",
        image: null, // Will use local image system
        infoLink: "https://books.google.com/books?id=ai-automation-audio",
        isAudiobook: true,
        localUrl: "/audiobooks/ai-automation.html",
        audiobook_number: "005"
      }
    ];

    // Utility functions
    function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
    
    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // Enhanced fetch with timeout and retry mechanisms
    async function fetchWithTimeout(url, opts = {}, timeout = CONFIG.TIMEOUT) {
      const ctrl = new AbortController();
      const id = setTimeout(() => ctrl.abort(), timeout);
      
      try {
        const response = await fetch(url, { 
          ...opts, 
          signal: ctrl.signal, 
          cache: 'default',
          headers: {
            'Accept': 'application/json',
            'Cache-Control': 'max-age=300',
            ...opts.headers
          }
        });
        
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        
        return response;
      } catch (error) {
        if (error.name === 'AbortError') {
          throw new Error('Request timed out');
        }
        throw error;
      } finally {
        clearTimeout(id);
      }
    }

    // Enhanced error handling for different error types
    function handleApiError(error, context = 'API') {
      console.error(`${context} error:`, error);
      
      let userMessage = 'Unable to load audiobooks';
      let shouldRetry = false;
      
      if (error.message.includes('timed out')) {
        userMessage = 'Request timed out - please check your connection';
        shouldRetry = true;
      } else if (error.message.includes('HTTP 429')) {
        userMessage = 'Too many requests - please wait a moment';
        shouldRetry = true;
      } else if (error.message.includes('HTTP 5')) {
        userMessage = 'Server error - please try again later';
        shouldRetry = true;
      } else if (!navigator.onLine) {
        userMessage = 'You appear to be offline';
        shouldRetry = true;
      } else if (error.message.includes('HTTP 4')) {
        userMessage = 'Unable to access audiobook data';
        shouldRetry = false;
      }
      
      return { userMessage, shouldRetry };
    }

    // Enhanced HD image handling with multiple resolution support for audiobooks
    function getImageResolutions(audiobook) {
      const baseName = audiobook.title.toLowerCase()
        .replace(/[^a-z0-9\s-]/g, '')
        .replace(/\s+/g, '-')
        .replace(/-+/g, '-')
        .trim();
      
      // Extract Google Books ID from URL
      let googleBooksId = '';
      if (audiobook.infoLink && audiobook.infoLink.includes('id=')) {
        googleBooksId = audiobook.infoLink.split('id=')[1];
      }
      
      // Check for audiobook_number format from the data
      const audiobookNumber = getAudiobookNumber(audiobook);
      
      const resolutions = {
        // HD zoom versions (highest quality)
        zoom5: audiobookNumber ? `/assets/harvested/audiobooks/audiobook_${audiobookNumber}_${audiobook.title.replace(/[^a-zA-Z0-9\s]/g, '').replace(/\s+/g, '_')}_zoom5.jpg` : null,
        
        // Thumbnail versions (medium quality)  
        thumbnail: audiobookNumber ? `/assets/harvested/audiobooks/audiobook_${audiobookNumber}_${audiobook.title.replace(/[^a-zA-Z0-9\s]/g, '').replace(/\s+/g, '_')}_thumbnail.jpg` : null,
        
        // Google Books covers (fallback)
        googleBooks: googleBooksId ? `/assets/harvested/audiobooks/${baseName}_${googleBooksId}_cover.jpg` : null,
        
        // Use existing image if available
        existing: audiobook.image || null,
        
        // Legacy paths
        legacy: [
          `/assets/harvested/audiobooks/${baseName}.jpg`,
          `/assets/images/${baseName}_cover.jpg`,
          `/assets/images/${baseName}.jpg`
        ],
        
        // Final fallback
        placeholder: '/assets/placeholder-cover.svg'
      };
      
      return resolutions;
    }

    function getAudiobookNumber(audiobook) {
      // Extract audiobook number from catalog data if available
      if (audiobook.audiobook_number) return audiobook.audiobook_number;
      
      // Create mapping based on known HD audiobook images
      const titleMappings = {
        'unstoppable unlock your potential': '001',
        'python zero to hero audiobook edition': '002', 
        'le code de guerison de la nature edition audio': '003',
        'music producer workflow audiobook': '004',
        'ai automation for creators audiobook': '005',
        'chess mastery audio edition': '006',
        'ableton elevation dj id01ts complete guide to building hits and elevating your sound': '007',
        'beat alchemy the dj id01t guide to mastering fl studio and making hits': '008',
        'ai in education': '009',
        'bite by bite': '010',
        'before the storm': '011',
        'anarchie et evolution lhistoire de la musique punk': '012',
        'anarchy and evolution': '013',
        'agentic ai sprint for solopreneurs': '014',
        'ai cash empire': '015',
        'ai goldmine 100 passive income ideas using chatgpt and free ai tools': '016',
        'ai revolution how automation is transforming everyday life': '017',
        'automation and seo mastery strategies for growth and efficiency': '018',
        'beneath the bloom': '019',
        'beyond the event horizon solving the black hole information paradox': '020',
        'bridging worlds a practical guide to connecting with parallel energies and dimensions': '021',
        'c zero to hero': '022',
        'chess mastery': '023',
        'christ quil est intelligent daimer': '024',
        'code in every language master programming with chatgpt': '025'
      };
      
      const cleanTitle = audiobook.title.toLowerCase()
        .replace(/[ð¿â¨ð§ðð]+\s*/g, '') // Remove emoji prefixes
        .replace(/[^a-z0-9\s]/g, '') // Remove special chars
        .replace(/\s+/g, ' ')
        .trim();
      
      // Check direct mapping first
      if (titleMappings[cleanTitle]) {
        return titleMappings[cleanTitle];
      }
      
      // Try partial matches for longer titles
      for (const [key, value] of Object.entries(titleMappings)) {
        if (cleanTitle.includes(key) || key.includes(cleanTitle)) {
          return value;
        }
      }
      
      // Try to extract from title or other fields
      const match = audiobook.title.match(/audiobook[_\s]?(\d+)/i);
      if (match) return String(parseInt(match[1])).padStart(3, '0');
      
      return null;
    }

    function getImagePath(audiobook) {
      const resolutions = getImageResolutions(audiobook);
      
      // Priority order: existing image â HD zoom5 â Google Books â thumbnail â placeholder
      return resolutions.existing || 
             resolutions.zoom5 || 
             resolutions.googleBooks || 
             resolutions.thumbnail || 
             resolutions.placeholder;
    }

    function createResponsiveImageSrcSet(audiobook) {
      const resolutions = getImageResolutions(audiobook);
      const srcset = [];
      
      // Add available resolutions to srcset in optimal order
      if (resolutions.thumbnail) {
        srcset.push(`${resolutions.thumbnail} 300w`);
      }
      if (resolutions.existing) {
        srcset.push(`${resolutions.existing} 400w`);
      }
      if (resolutions.googleBooks) {
        srcset.push(`${resolutions.googleBooks} 400w`);
      }
      if (resolutions.zoom5) {
        srcset.push(`${resolutions.zoom5} 800w`);
      }
      
      return srcset.length > 0 ? srcset.join(', ') : '';
    }

    function getOptimalImageSize(containerWidth = 300) {
      // Determine optimal image based on container size and device pixel ratio
      const pixelRatio = window.devicePixelRatio || 1;
      const targetWidth = containerWidth * pixelRatio;
      
      if (targetWidth <= 300) return 'thumbnail';
      if (targetWidth <= 600) return 'googleBooks'; 
      return 'zoom5';
    }

    function createAdvancedImageFallback(audiobook, className = '') {
      const resolutions = getImageResolutions(audiobook);
      const srcset = createResponsiveImageSrcSet(audiobook);
      const primarySrc = getImagePath(audiobook);
      
      return `
        <img 
          src="${primarySrc}"
          ${srcset ? `srcset="${srcset}"` : ''}
          sizes="(max-width: 640px) 300px, (max-width: 1024px) 400px, 800px"
          alt="${audiobook.title.replace(/^[ð¿â¨ð§ðð]+\s*/, '')} audiobook cover"
          class="${className}"
          loading="lazy"
          decoding="async"
          tabindex="0"
          onerror="handleImageError(this, '${JSON.stringify(resolutions).replace(/"/g, '&quot;')}')"
        />
      `;
    }

    function handleImageError(img, resolutionsJson) {
      try {
        const resolutions = JSON.parse(resolutionsJson.replace(/&quot;/g, '"'));
        const currentSrc = img.src;
        
        // Try fallback hierarchy
        if (currentSrc.includes('zoom5') && resolutions.thumbnail) {
          img.src = resolutions.thumbnail;
        } else if (currentSrc.includes('thumbnail') && resolutions.googleBooks) {
          img.src = resolutions.googleBooks;
        } else if (currentSrc.includes('_cover.jpg') && resolutions.legacy.length > 0) {
          img.src = resolutions.legacy[0];
        } else {
          img.src = resolutions.placeholder;
          img.onerror = null; // Prevent infinite loop
        }
      } catch (e) {
        img.src = '/assets/placeholder-cover.svg';
        img.onerror = null;
      }
    }

    // Enhanced connection monitoring for audiobooks
    function initConnectionMonitoring() {
      if ('onLine' in navigator) {
        window.addEventListener('online', () => {
          console.log('Connection restored');
          const loading = document.getElementById('loading');
          if (loading && !loading.classList.contains('hidden')) {
            // Retry loading if we were in a loading state
            init();
          }
          hideOfflineIndicator();
        });

        window.addEventListener('offline', () => {
          console.log('Connection lost');
          showOfflineIndicator();
        });
      }
    }

    function showOfflineIndicator() {
      const existingIndicator = document.getElementById('offline-indicator');
      if (existingIndicator) return;

      const indicator = document.createElement('div');
      indicator.id = 'offline-indicator';
      indicator.className = 'fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center gap-2';
      indicator.innerHTML = `
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        You are offline
      `;
      document.body.appendChild(indicator);
    }

    function hideOfflineIndicator() {
      const indicator = document.getElementById('offline-indicator');
      if (indicator) {
        indicator.remove();
      }
    }

    // Progressive Image Loading with Intersection Observer
    let imageObserver = null;

    function initializeImageObserver() {
      if ('IntersectionObserver' in window) {
        imageObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const img = entry.target;
              loadImageProgressive(img);
              imageObserver.unobserve(img);
            }
          });
        }, {
          rootMargin: '50px 0px',
          threshold: 0.1
        });
      }
    }

    function loadImageProgressive(img) {
      const placeholder = img.parentElement.querySelector('.image-placeholder');
      
      // Add blur-to-sharp loading effect
      img.style.filter = 'blur(5px)';
      img.style.opacity = '0';
      img.style.transition = 'all 0.3s ease-in-out';
      
      img.onload = function() {
        // Hide placeholder with fade out
        if (placeholder) {
          placeholder.style.opacity = '0';
          setTimeout(() => placeholder.remove(), 300);
        }
        
        // Show image with blur-to-sharp effect
        img.style.opacity = '1';
        img.style.filter = 'blur(0px)';
        img.classList.add('image-loaded');
      };
      
      // Start loading the image
      if (img.dataset.src) {
        img.src = img.dataset.src;
      }
    }

    function observeImages() {
      if (imageObserver) {
        document.querySelectorAll('img[loading="lazy"]:not(.image-loaded)').forEach(img => {
          imageObserver.observe(img);
        });
      }
    }

    // Image preloading for better UX
    function preloadNextPageImages() {
      const nextPageStart = currentPage * itemsPerPage;
      const nextPageEnd = Math.min(nextPageStart + itemsPerPage, filteredAudiobooks.length);
      
      for (let i = nextPageStart; i < nextPageEnd; i++) {
        const audiobook = filteredAudiobooks[i];
        if (audiobook) {
          const resolutions = getImageResolutions(audiobook);
          
          // Preload thumbnail first (smaller, faster)
          if (resolutions.thumbnail) {
            const preloadLink = document.createElement('link');
            preloadLink.rel = 'preload';
            preloadLink.as = 'image';
            preloadLink.href = resolutions.thumbnail;
            document.head.appendChild(preloadLink);
          }
        }
      }
    }

    // Global error handlers
    function handleGlobalError(event) {
      console.error('Global error:', event.error);
      // Could send to analytics or error reporting service
    }

    function handleUnhandledRejection(event) {
      console.error('Unhandled promise rejection:', event.reason);
      // Could send to analytics or error reporting service
    }

    // Initialize everything with comprehensive error handling
    function initializePage() {
      try {
        // Initialize theme with error handling
        try {
          initTheme();
        } catch (e) {
          console.warn('Theme initialization failed:', e);
        }

        // Initialize mobile menu with error handling
        try {
          initMobileMenu();
        } catch (e) {
          console.warn('Mobile menu initialization failed:', e);
        }

        // Initialize intersection observers with error handling
        try {
          initializeIntersectionObservers();
        } catch (e) {
          console.warn('Intersection observer initialization failed:', e);
        }

        // Initialize image observer with error handling
        try {
          initializeImageObserver();
        } catch (e) {
          console.warn('Image observer initialization failed:', e);
        }

        // Initialize connection monitoring
        try {
          initConnectionMonitoring();
        } catch (e) {
          console.warn('Connection monitoring initialization failed:', e);
        }

        // Load audiobooks
        init();

        // Add global error handler
        window.addEventListener('error', handleGlobalError);
        window.addEventListener('unhandledrejection', handleUnhandledRejection);

      } catch (error) {
        console.error('Page initialization failed:', error);
        document.body.innerHTML = `
          <div class="min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900">
            <div class="text-center p-8">
              <h1 class="text-2xl font-bold text-slate-900 dark:text-white mb-4">Something went wrong</h1>
              <p class="text-slate-600 dark:text-slate-300 mb-6">We're having trouble loading the page. Please try refreshing.</p>
              <button onclick="window.location.reload()" class="px-6 py-3 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors">
                Refresh Page
              </button>
            </div>
          </div>
        `;
      }
    }

    // Initialize intersection observers separately for better error handling
    function initializeIntersectionObservers() {
      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.3 });
      
      document.querySelectorAll('.intersection-animate').forEach(el => {
        try {
          observer.observe(el);
        } catch (e) {
          console.warn('Failed to observe element:', el, e);
          // Fallback: just add visible class
          el.classList.add('visible');
        }
      });
    }

    // Initialize mobile menu separately
    function initMobileMenu() {
      const mobileBtn = document.getElementById('mobileMenuBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      const menuIcon = document.getElementById('menuIcon');
      const closeIcon = document.getElementById('closeIcon');
      
      if (!mobileBtn || !mobileMenu) {
        console.warn('Mobile menu elements not found');
        return;
      }

      mobileBtn.addEventListener('click', () => {
        try {
          const isOpen = !mobileMenu.classList.contains('hidden');
          mobileMenu.classList.toggle('hidden');
          mobileBtn.setAttribute('aria-expanded', String(!isOpen));
          
          if (menuIcon && closeIcon) {
            menuIcon.classList.toggle('hidden', !isOpen);
            closeIcon.classList.toggle('hidden', isOpen);
          }
          
          if (!isOpen) {
            const firstLink = mobileMenu.querySelector('a');
            if (firstLink) firstLink.focus();
          } else {
            mobileBtn.focus();
          }
        } catch (e) {
          console.warn('Mobile menu toggle failed:', e);
        }
      });
    }

    // Enhanced book normalization with validation and local image handling
    function normalizeBook(item) {
      try {
        if (!item || !item.volumeInfo) {
          throw new Error('Invalid book data structure');
        }

        const volumeInfo = item.volumeInfo;

        // Validate required fields
        if (!volumeInfo.title) {
          console.warn('Book missing title:', item.id);
          return null;
        }

        // Use local image system instead of external APIs
        const normalizedBook = {
          id: item.id || `book-${Date.now()}-${Math.random()}`,
          title: volumeInfo.title || 'Untitled',
          authors: (volumeInfo.authors || []).join(', ') || 'Unknown Author',
          year: parseInt((volumeInfo.publishedDate || '').slice(0, 4)) || null,
          language: volumeInfo.language || 'en',
          categories: volumeInfo.categories || [],
          description: volumeInfo.description || '',
          image: null, // Will be handled by getImagePath function
          infoLink: (volumeInfo.infoLink || volumeInfo.canonicalVolumeLink || '#').replace('http://', 'https://'),
          isAudiobook: isAudiobook(volumeInfo),
          localUrl: null
        };

        return normalizedBook;
      } catch (error) {
        console.warn('Error normalizing book:', error, item);
        return null;
      }
    }

    // Enhanced audiobook detection
    function isAudiobook(volumeInfo) {
      const title = `${volumeInfo.title || ''} ${volumeInfo.subtitle || ''}`.toLowerCase();
      const categories = (volumeInfo.categories || []).join(' ').toLowerCase();
      const description = (volumeInfo.description || '').toLowerCase();
      const authors = (volumeInfo.authors || []).join(' ').toLowerCase();
      const publisher = (volumeInfo.publisher || '').toLowerCase();
      
      // Comprehensive audio keywords
      const audioKeywords = [
        'audiobook', 'audio book', 'audio-book', 'audiobooks',
        'spoken word', 'spoken-word', 'spokenword',
        'narrated', 'narrator', 'narrators', 'narration',
        'unabridged', 'abridged', 'full-length', 'full length',
        'voice', 'voiced', 'voiceover', 'voice-over',
        'audio', 'audible', 'listening', 'listen',
        'recording', 'recorded', 'sound', 'audio edition',
        'audio version', 'audio-version', 'audioversion',
        'mp3', 'cd', 'cds', 'disc', 'discs',
        'playaway', 'playaway audiobook',
        'talking book', 'talking-book', 'talkingbook',
        'read aloud', 'read-aloud', 'readaloud',
        'performance', 'performed', 'performer',
        'dramatization', 'dramatized', 'drama',
        'theatrical', 'theater', 'theatre',
        'podcast', 'podcasts', 'episode', 'episodes',
        'lecture', 'lectures', 'lecturer', 'lecturing',
        'sermon', 'sermons', 'preaching', 'preacher',
        'storytelling', 'story-telling', 'storyteller',
        'oral', 'orally', 'verbal', 'verbally',
        'acoustic', 'acoustics', 'soundtrack', 'sound track',
        'music', 'musical', 'score', 'scoring',
        'radio', 'radio drama', 'radio play',
        'broadcast', 'broadcasting', 'broadcasted',
        'streaming', 'stream', 'streamed',
        'download', 'downloadable', 'digital audio',
        'digital-audio', 'digitalaudio'
      ];

      // Check for audio keywords in various fields
      const hasAudioKeyword = audioKeywords.some(keyword => 
        title.includes(keyword) || 
        categories.includes(keyword) || 
        description.includes(keyword) ||
        authors.includes(keyword) ||
        publisher.includes(keyword)
      );

      // Additional checks for specific patterns
      const hasAudioPattern = 
        /audio\s*(book|edition|version|format)/i.test(title) ||
        /(unabridged|abridged)\s*(audio|edition|version)/i.test(title) ||
        /(narrated|read)\s*by/i.test(description) ||
        /(audio|spoken)\s*(narrator|reader)/i.test(description) ||
        /(listening|audible)\s*(book|edition|version)/i.test(description) ||
        /(cd|disc|mp3|audio)\s*(book|edition|version)/i.test(title) ||
        /(playaway|talking)\s*(book|audiobook)/i.test(title);

      // Check if it's from Guillaume Lessard or iD01t Productions (likely audiobooks)
      const isFromTargetAuthor = authors.includes('guillaume lessard') || 
                                publisher.includes('id01t productions') ||
                                publisher.includes('id01t');

      // Return true if it has audio keywords, patterns, or is from target author/publisher
      return hasAudioKeyword || hasAudioPattern || isFromTargetAuthor;
    }

    // Normalize book data
    function normalizeBook(item) {
      const volumeInfo = item.volumeInfo || {};
      const imageLinks = volumeInfo.imageLinks || {};

      // Handle Google Books images with CORS issues
      let imageUrl = imageLinks.thumbnail || imageLinks.smallThumbnail || '/assets/img/placeholders/card-portrait-384x576.webp';
      
      // For Google Books images, use a CORS proxy or fallback to placeholder
      if (imageUrl.includes('books.google.com')) {
        // Use a CORS proxy service for Google Books images
        const bookId = item.id;
        if (bookId) {
          // Try multiple approaches for getting the image
          const originalUrl = imageLinks.thumbnail || imageLinks.smallThumbnail;
          if (originalUrl) {
            // Use a CORS proxy
            imageUrl = `https://images.weserv.nl/?url=${encodeURIComponent(originalUrl)}&w=400&h=600&fit=cover`;
          } else {
            // Fallback to placeholder
            imageUrl = '/assets/img/placeholders/card-portrait-384x576.webp';
          }
        } else {
          imageUrl = '/assets/img/placeholders/card-portrait-384x576.webp';
        }
      }
      
      imageUrl = imageUrl.replace('http://', 'https://');
      
      return {
        id: item.id,
        title: volumeInfo.title || 'Untitled',
        authors: (volumeInfo.authors || []).join(', '),
        year: parseInt((volumeInfo.publishedDate || '').slice(0, 4)) || null,
        language: volumeInfo.language || 'en',
        categories: volumeInfo.categories || [],
        description: volumeInfo.description || '',
        image: imageUrl,
        infoLink: (volumeInfo.infoLink || volumeInfo.canonicalVolumeLink || '#').replace('http://', 'https://'),
        isAudiobook: isAudiobook(volumeInfo),
        localUrl: null
      };
    }

    // Enhanced create book card with better error handling and accessibility
    function createCard(book) {
      try {
        if (!book || !book.title) {
          console.warn('Invalid book data for card creation:', book);
          return createErrorCard('Invalid book data');
        }

        const linkUrl = book.localUrl || book.infoLink || '#';
        const linkTarget = book.localUrl ? '_self' : '_blank';
        const linkRel = book.localUrl ? '' : 'noopener nofollow';
        const safeTitle = escapeHtml(book.title);
        const safeAuthors = escapeHtml(book.authors || 'Unknown Author');
        const safeYear = book.year || '';
        
        // Use enhanced image fallback system with local HD support
        const imageHTML = createAdvancedImageFallback(book, 'w-full aspect-[3/4] object-cover rounded-lg transition-transform duration-300 group-hover:scale-105');

        return `
          <article class="group bg-white dark:bg-slate-800 rounded-2xl shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden border border-slate-200 dark:border-slate-700">
            <div class="relative">
              <div class="aspect-[3/4] bg-slate-100 dark:bg-slate-900 overflow-hidden relative">
                <div class="absolute inset-0 bg-gradient-to-br from-slate-200 to-slate-300 dark:from-slate-700 dark:to-slate-800 animate-pulse image-placeholder"></div>
                ${imageHTML}
              </div>
              ${book.isAudiobook ? '<div class="absolute top-2 right-2 bg-blue-600 text-white text-xs px-2 py-1 rounded-full flex items-center gap-1"><svg class="h-3 w-3" fill="currentColor" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>Audio</div>' : ''}
            </div>
            
            <div class="p-6 space-y-3">
              <div class="space-y-2">
                <h3 class="font-semibold text-lg text-slate-900 dark:text-white line-clamp-2 leading-tight">
                  ${safeTitle}
                </h3>
                <p class="text-sm text-slate-600 dark:text-slate-400">
                  by ${safeAuthors}
                </p>
                ${safeYear ? `<p class="text-sm text-slate-500 dark:text-slate-500">${safeYear}</p>` : ''}
                ${book.categories && book.categories.length > 0 ? 
                  `<div class="flex flex-wrap gap-1">
                    ${book.categories.slice(0, 2).map(cat => 
                      `<span class="px-2 py-1 text-xs bg-brand-100 dark:bg-brand-900 text-brand-700 dark:text-brand-300 rounded-full">${escapeHtml(cat)}</span>`
                    ).join('')}
                  </div>` : ''
                }
              </div>
              
              <div class="pt-3 border-t border-slate-200 dark:border-slate-700">
                <a href="${linkUrl}" 
                   target="${linkTarget}" 
                   ${linkRel ? `rel="${linkRel}"` : ''}
                   class="inline-flex items-center gap-2 text-brand-600 hover:text-brand-700 dark:text-brand-400 dark:hover:text-brand-300 text-sm font-medium transition-colors focus-ring rounded px-2 py-1"
                   ${linkUrl === '#' ? 'style="opacity: 0.5; cursor: not-allowed;"' : ''}>
                  <span>View Details</span>
                  <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                </a>
              </div>
            </div>
          </article>
        `;
      } catch (error) {
        console.error('Error creating book card:', error, book);
        return createErrorCard(`Error loading "${book?.title || 'Unknown'}" audiobook`);
      }
    }

    // Create error card for failed book renders
    function createErrorCard(message = 'Error loading audiobook') {
      return `
        <article class="group bg-slate-100 dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 opacity-75">
          <div class="p-6 text-center space-y-3">
            <div class="text-slate-500 dark:text-slate-400">
              <svg class="h-12 w-12 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <p class="text-sm font-medium">${escapeHtml(message)}</p>
            </div>
          </div>
        </article>
      `;
    }

    // Enhanced render books with comprehensive error handling
    function renderBooks(filtered, allBooks) {
      try {
        const loading = document.getElementById('loading');
        const grid = document.getElementById('grid');
        const empty = document.getElementById('empty');
        const count = document.getElementById('count');
        const tally = document.getElementById('tally');

        if (!grid) {
          console.error('Grid element not found');
          return;
        }

        loading.classList.add('hidden');
        
        if (!filtered || !filtered.length) {
          grid.classList.add('hidden');
          if (empty) empty.classList.remove('hidden');
          if (count) count.textContent = '0 audiobooks';
          return;
        }

        if (empty) empty.classList.add('hidden');
        grid.classList.remove('hidden');
        
        // Create cards with error handling for each book
        const cardsHTML = filtered.map(book => {
          try {
            return createCard(book);
          } catch (e) {
            console.warn('Failed to create card for book:', book, e);
            return createErrorCard(`Error loading "${book?.title || 'Unknown'}" audiobook`);
          }
        }).filter(Boolean).join('');
        
        grid.innerHTML = cardsHTML;
        
        // Update counters with error handling
        try {
          const audiobookCount = allBooks ? allBooks.filter(book => book && book.isAudiobook).length : 0;
          if (count) count.textContent = `${filtered.length} audiobook${filtered.length !== 1 ? 's' : ''}`;
          if (tally) tally.textContent = `${allBooks?.length || 0} titles â¢ ${audiobookCount} audiobooks`;
        } catch (e) {
          console.warn('Error updating counters:', e);
        }

        // Initialize image loading observers
        initImageObservers();

      } catch (error) {
        console.error('Error rendering books:', error);
        showErrorState('Error displaying audiobooks');
      }
    }

    // Initialize image observers for lazy loading and error handling
    function initImageObservers() {
      try {
        if ('IntersectionObserver' in window) {
          const imageObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                const img = entry.target;
                // Image is already loaded due to loading="lazy", just observe for error handling
                imageObserver.unobserve(img);
              }
            });
          }, {
            rootMargin: '50px 0px',
            threshold: 0.1
          });

          // Observe all images in the grid
          document.querySelectorAll('#grid img').forEach(img => {
            imageObserver.observe(img);
          });
        }
      } catch (e) {
        console.warn('Failed to initialize image observers:', e);
      }
    }

    // Show error state in the UI
    function showErrorState(message = 'Something went wrong') {
      const loading = document.getElementById('loading');
      const grid = document.getElementById('grid');
      
      if (loading) {
        loading.innerHTML = `
          <div class="text-center py-12">
            <div class="text-red-500 dark:text-red-400 mb-4">
              <svg class="h-12 w-12 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <p class="text-lg font-medium">${escapeHtml(message)}</p>
            </div>
            <button onclick="init()" class="mt-4 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors focus-ring">
              Try Again
            </button>
          </div>
        `;
        loading.classList.remove('hidden');
      }
      
      if (grid) {
        grid.classList.add('hidden');
      }
    }

    // Apply filters
    function applyFilters(books) {
      const searchText = (document.getElementById('q').value || '').toLowerCase().trim();
      const selectedLanguage = document.getElementById('language').value;
      const fromYear = parseInt(document.getElementById('from').value) || null;
      const toYear = parseInt(document.getElementById('to').value) || null;
      const sortBy = document.getElementById('sort').value;

      let filtered = books.filter(book => {
        if (searchText) {
          const searchableText = [book.title, book.authors, book.description, (book.categories || []).join(' ')].join(' ').toLowerCase();
          if (!searchableText.includes(searchText)) return false;
        }
        if (selectedLanguage && book.language !== selectedLanguage) return false;
        if (fromYear && (!book.year || book.year < fromYear)) return false;
        if (toYear && (!book.year || book.year > toYear)) return false;
        return book.isAudiobook;
      });

      // Sort results
      filtered.sort((a, b) => {
        switch (sortBy) {
          case 'date_asc': return (a.year || 0) - (b.year || 0);
          case 'title_asc': return a.title.localeCompare(b.title);
          case 'title_desc': return b.title.localeCompare(a.title);
          default: return (b.year || 0) - (a.year || 0);
        }
      });

      return filtered;
    }

    // Render books
    function renderBooks(filtered, allBooks) {
      const loading = document.getElementById('loading');
      const grid = document.getElementById('grid');
      const empty = document.getElementById('empty');
      const count = document.getElementById('count');
      const tally = document.getElementById('tally');

      loading.classList.add('hidden');
      
      if (!filtered.length) {
        grid.classList.add('hidden');
        empty.classList.remove('hidden');
        count.textContent = '0 audiobooks';
        return;
      }

      empty.classList.add('hidden');
      grid.classList.remove('hidden');
      grid.innerHTML = filtered.map(createCard).join('');
      
      const audiobookCount = allBooks.filter(book => book.isAudiobook).length;
      count.textContent = `${filtered.length} audiobook${filtered.length !== 1 ? 's' : ''}`;
      tally.textContent = `${allBooks.length} titles â¢ ${audiobookCount} audiobooks`;
    }

    // Populate language filter
    function populateLanguages(books) {
      const language = document.getElementById('language');
      const languages = [...new Set(books.map(book => book.language).filter(Boolean))].sort();
      language.innerHTML = '<option value="">All languages</option>' +
        languages.map(lang => `<option value="${lang}">${lang}</option>`).join('');
    }

    // Setup event listeners
    function setupEventListeners(allBooks) {
      const updateResults = () => renderBooks(applyFilters(allBooks), allBooks);
      
      ['input', 'change'].forEach(eventType => {
        ['q', 'language', 'from', 'to', 'sort'].forEach(id => {
          const element = document.getElementById(id);
          if (element) {
            element.addEventListener(eventType, updateResults);
          }
        });
      });

      const resetBtn = document.getElementById('reset');
      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          document.getElementById('q').value = '';
          document.getElementById('language').value = '';
          document.getElementById('from').value = '';
          document.getElementById('to').value = '';
          document.getElementById('sort').value = 'date_desc';
        updateResults();
      });
    }

      const refreshBtn = document.getElementById('refresh');
      if (refreshBtn) {
        refreshBtn.addEventListener('click', () => {
          localStorage.removeItem('id01t_audiobooks_cache');
          init();
        });
      }
    }

    // Enhanced search queries for comprehensive audiobook discovery
    const SEARCH_QUERIES = [
      `inauthor:"${CONFIG.AUTHOR}"`,
      `inpublisher:"${CONFIG.PUBLISHER}"`,
      `"${CONFIG.AUTHOR}" audiobook`,
      `"${CONFIG.AUTHOR}" audio book`,
      `"${CONFIG.AUTHOR}" narrated`,
      `"${CONFIG.PUBLISHER}" audiobook`,
      `"${CONFIG.PUBLISHER}" audio book`,
      `"${CONFIG.PUBLISHER}" narrated`,
      `"Guillaume Lessard" "spoken word"`,
      `"iD01t Productions" "spoken word"`,
      `"Guillaume Lessard" "unabridged"`,
      `"iD01t Productions" "unabridged"`,
      `"Guillaume Lessard" "abridged"`,
      `"iD01t Productions" "abridged"`
    ];

    // Fetch from Google Books API with multiple search strategies
    async function fetchFromGoogleBooks() {
      let allItems = [];
      const seenIds = new Set();

      // Process each search query
      for (const query of SEARCH_QUERIES) {
        try {
          console.log(`ð Searching: ${query}`);
          const queryResults = await fetchBooksForQuery(query);
          
          // Add unique items only
          queryResults.forEach(item => {
            if (!seenIds.has(item.id)) {
              seenIds.add(item.id);
              allItems.push(item);
            }
          });
          
          console.log(`â Found ${queryResults.length} new items (${allItems.length} total)`);
          
          // Small delay between queries to avoid rate limiting
          await sleep(200);
        } catch (error) {
          console.warn(`Query "${query}" failed:`, error);
        }
      }

      console.log(`ð Total unique books found: ${allItems.length}`);
      return allItems;
    }

    // Fetch books for a specific query
    async function fetchBooksForQuery(query) {
      const items = [];

      for (let page = 0; page < CONFIG.MAX_PAGES; page++) {
        const start = page * CONFIG.PAGE_SIZE;
        const params = new URLSearchParams({
          q: query,
          maxResults: CONFIG.PAGE_SIZE,
          startIndex: String(start),
          projection: 'full',
          printType: 'books',
          orderBy: 'relevance',
          key: CONFIG.API_KEY
        });

        const url = `https://www.googleapis.com/books/v1/volumes?${params.toString()}`;
        
        let success = false;
        for (let attempt = 0; attempt < CONFIG.RETRIES && !success; attempt++) {
          try {
            const response = await fetchWithTimeout(url);
            if (!response.ok) {
              if (response.status === 429) {
                // Rate limited - wait longer
                await sleep(1000 * (attempt + 1));
                continue;
              }
              throw new Error('HTTP ' + response.status);
            }
            const data = await response.json();
            const pageItems = data.items || [];
            items.push(...pageItems);
            success = true;
      } catch (error) {
            console.warn(`Query attempt ${attempt + 1} failed:`, error);
            await sleep(200 * (attempt + 1));
          }
        }

        if (!success) break;
        if (items.length < (page + 1) * CONFIG.PAGE_SIZE) break;
      }

      return items;
    }

    // Enhanced main initialization with comprehensive error handling
    async function init() {
      try {
        const loading = document.getElementById('loading');
        if (loading) {
          loading.innerHTML = `
            <div class="inline-flex items-center gap-3 text-slate-600 dark:text-slate-300">
              <svg class="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              Loading audiobooks...
            </div>
          `;
          loading.classList.remove('hidden');
        }

        // Check online status
        if (!navigator.onLine) {
          throw new Error('No internet connection available');
        }

        console.log('ð§ Starting audiobook initialization...');
        
        let allBooks = [];
        let usesFallback = false;

        try {
          console.log('ð§ Fetching from Google Books API...');
          const rawBooks = await fetchFromGoogleBooks();
          console.log(`ð Raw books fetched: ${rawBooks.length}`);
          
          if (rawBooks.length === 0) {
            throw new Error('No books found from API');
          }

          // Normalize books with validation
          const normalizedBooks = rawBooks.map(normalizeBook).filter(Boolean);
          console.log(`ð Books normalized: ${normalizedBooks.length}`);
          
          if (normalizedBooks.length === 0) {
            throw new Error('No valid books after normalization');
          }

          // Log details about each book for debugging
          normalizedBooks.forEach((book, index) => {
            console.log(`Book ${index + 1}: "${book.title}" by ${book.authors} - Audiobook: ${book.isAudiobook}`);
          });
          
          let audiobooks = normalizedBooks.filter(b => b.isAudiobook);
          console.log(`ð§ Audiobooks identified: ${audiobooks.length}`);

          if (audiobooks.length === 0) {
            console.log('ð No audiobooks found in API, marking relevant books as audiobooks...');
            // Mark all books as audiobooks if they're from our target author/publisher
            normalizedBooks.forEach(book => {
              if (book.authors.toLowerCase().includes('guillaume lessard') || 
                  book.authors.toLowerCase().includes('id01t')) {
                book.isAudiobook = true;
                console.log(`ð§ Marking as audiobook: "${book.title}"`);
              }
            });
            
            audiobooks = normalizedBooks.filter(b => b.isAudiobook);
            
            if (audiobooks.length === 0) {
              console.log('ð Still no audiobooks found, using fallback data...');
              allBooks = [...FALLBACK_DATA];
              usesFallback = true;
            } else {
              console.log(`â Found ${audiobooks.length} books from Guillaume Lessard/iD01t Productions!`);
              allBooks = normalizedBooks;
            }
          } else {
            console.log('â Found audiobooks from Google Books API!');
            allBooks = normalizedBooks;
          }

        } catch (apiError) {
          console.error('â API failed:', apiError);
          const errorInfo = handleApiError(apiError, 'Google Books API');
          
          if (errorInfo.shouldRetry && !usesFallback) {
            // Show retry option
            if (loading) {
              loading.innerHTML = `
                <div class="text-center py-12">
                  <div class="text-orange-500 dark:text-orange-400 mb-4">
                    <svg class="h-12 w-12 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <p class="text-lg font-medium">${errorInfo.userMessage}</p>
                  </div>
                  <div class="space-x-4">
                    <button onclick="init()" class="px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors focus-ring">
                      Retry
                    </button>
                    <button onclick="initWithFallback()" class="px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors focus-ring">
                      Use Offline Data
                    </button>
                  </div>
                </div>
              `;
              return;
            }
          }
          
          console.log('Using fallback data due to API failure');
          allBooks = [...FALLBACK_DATA];
          usesFallback = true;
        }

        console.log(`ð Final: ${allBooks.length} books`);
        
        if (allBooks.length === 0) {
          throw new Error('No audiobooks available');
        }

        // Initialize UI components with error handling
        try {
          populateLanguages(allBooks);
        } catch (e) {
          console.warn('Failed to populate languages:', e);
        }

        try {
          setupEventListeners(allBooks);
        } catch (e) {
          console.warn('Failed to setup event listeners:', e);
        }

        try {
          renderBooks(applyFilters(allBooks), allBooks);
        } catch (e) {
          console.error('Failed to render books:', e);
          showErrorState('Error displaying audiobooks');
          return;
        }

        // Show success message if using fallback
        if (usesFallback) {
          setTimeout(() => {
            const indicator = document.createElement('div');
            indicator.className = 'fixed top-4 left-4 bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm';
            indicator.innerHTML = 'â ï¸ Showing offline audiobook collection';
            document.body.appendChild(indicator);
            
            setTimeout(() => indicator.remove(), 5000);
          }, 1000);
        }
        
      } catch (error) {
        console.error('â Initialization failed completely:', error);
        showErrorState(`Failed to load audiobooks: ${error.message}`);
      }
    }

    // Fallback initialization function
    function initWithFallback() {
      try {
        console.log('ð§ Initializing with fallback data only...');
        const allBooks = [...FALLBACK_DATA];
        
        populateLanguages(allBooks);
        setupEventListeners(allBooks);
        renderBooks(applyFilters(allBooks), allBooks);
        
        // Show offline indicator
        const indicator = document.createElement('div');
        indicator.className = 'fixed top-4 left-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm';
        indicator.innerHTML = 'ð Showing offline audiobook collection';
        document.body.appendChild(indicator);
        
        setTimeout(() => indicator.remove(), 5000);
        
      } catch (error) {
        console.error('â Fallback initialization failed:', error);
        showErrorState('Failed to load offline audiobooks');
      }
    }

    // Enhanced event listener setup with error boundaries
    function setupEventListeners(allBooks) {
      try {
        const updateResults = () => {
          try {
            renderBooks(applyFilters(allBooks), allBooks);
          } catch (e) {
            console.error('Error updating results:', e);
            showErrorState('Error filtering audiobooks');
          }
        };
        
        // Debounced search to prevent excessive filtering
        const debouncedUpdate = debounce(updateResults, 300);
        
        ['q', 'language', 'from', 'to', 'sort'].forEach(id => {
          const element = document.getElementById(id);
          if (element) {
            const eventType = id === 'q' ? 'input' : 'change';
            element.addEventListener(eventType, eventType === 'input' ? debouncedUpdate : updateResults);
          }
        });

        const resetBtn = document.getElementById('reset');
        if (resetBtn) {
          resetBtn.addEventListener('click', () => {
            try {
              ['q', 'language', 'from', 'to'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
              });
              const sortElement = document.getElementById('sort');
              if (sortElement) sortElement.value = 'date_desc';
              updateResults();
            } catch (e) {
              console.error('Error resetting filters:', e);
            }
          });
        }

        const refreshBtn = document.getElementById('refresh');
        if (refreshBtn) {
          refreshBtn.addEventListener('click', () => {
            try {
              localStorage.removeItem('id01t_audiobooks_cache');
              init();
            } catch (e) {
              console.error('Error refreshing:', e);
            }
          });
        }

      } catch (error) {
        console.error('Error setting up event listeners:', error);
      }
    }

    // Debounce function to prevent excessive API calls
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Enhanced initialization with comprehensive error handling
    function initializePage() {
      try {
        // Initialize connection monitoring
        initConnectionMonitoring();

        // Initialize theme with error handling
        try {
          const currentTheme = initTheme();
          setupThemeToggle(currentTheme);
        } catch (e) {
          console.warn('Theme initialization failed:', e);
        }

        // Initialize mobile menu with error handling
        try {
          setupMobileMenu();
        } catch (e) {
          console.warn('Mobile menu initialization failed:', e);
        }

        // Set current year
        try {
          const yearElement = document.getElementById('year');
          if (yearElement) {
            yearElement.textContent = new Date().getFullYear();
          }
        } catch (e) {
          console.warn('Year initialization failed:', e);
        }

        // Start main initialization
        init();

        // Add global error handlers
        window.addEventListener('error', (event) => {
          console.error('Global error:', event.error);
        });

        window.addEventListener('unhandledrejection', (event) => {
          console.error('Unhandled promise rejection:', event.reason);
        });

      } catch (error) {
        console.error('Page initialization failed:', error);
        showErrorState('Failed to initialize audiobooks page');
      }
    }

    // Setup theme toggle with error handling
    function setupThemeToggle(currentTheme) {
      const themeToggle = document.getElementById('themeToggle');
      if (themeToggle) {
        themeToggle.setAttribute('aria-pressed', String(currentTheme));
        const themeText = themeToggle.querySelector('.theme-text');
        if (themeText) {
          themeText.textContent = currentTheme ? 'Light' : 'Dark';
        }
        
        themeToggle.addEventListener('click', function() {
          try {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            themeToggle.setAttribute('aria-pressed', String(isDark));
            if (themeText) {
              themeText.textContent = isDark ? 'Light' : 'Dark';
            }
          } catch (e) {
            console.warn('Theme toggle failed:', e);
          }
        });
      }
    }

    // Setup mobile menu with error handling
    function setupMobileMenu() {
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      const menuIcon = document.getElementById('menuIcon');
      const closeIcon = document.getElementById('closeIcon');
      
      if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', function() {
          try {
            const isOpen = !mobileMenu.classList.contains('hidden');
            mobileMenu.classList.toggle('hidden');
            mobileMenuBtn.setAttribute('aria-expanded', String(!isOpen));
            
            if (menuIcon && closeIcon) {
              menuIcon.classList.toggle('hidden', !isOpen);
              closeIcon.classList.toggle('hidden', isOpen);
            }
          } catch (e) {
            console.warn('Mobile menu toggle failed:', e);
          }
        });
      }
    }

    // Start when DOM is ready with comprehensive error handling
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializePage);
    } else {
      // DOM already loaded
      setTimeout(initializePage, 0);
    }

    // Expose functions globally for button onclick handlers
    window.init = init;
    window.initWithFallback = initWithFallback;
    window.handleImageError = handleImageError;
  </script>
</body>
</html>
