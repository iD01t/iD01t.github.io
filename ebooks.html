<!doctype html>
<html class="scroll-smooth" lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>iD01t Productions — eBooks Catalog</title>
  <meta name="description" content="Browse all eBooks by Guillaume Lessard and iD01t Productions, pulled live from Google Books."/>
  <link rel="canonical" href="/ebooks.html"/>

  <!-- Social -->
  <meta property="og:title" content="iD01t Productions — eBooks Catalog"/>
  <meta property="og:description" content="Complete Google Books-powered catalog with search and filters."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://id01t.github.io/ebooks.html"/>
  <meta property="og:image" content="/assets/img/brand/ebooks_og.jpg"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="iD01t Productions — eBooks Catalog"/>
  <meta name="twitter:description" content="Discover all titles by Guillaume Lessard and iD01t Productions."/>
  <meta name="twitter:image" content="/assets/img/brand/ebooks_og.jpg"/>

  <link rel="icon" type="image/x-icon" href="/assets/favicon.ico"/>
  <link rel="apple-touch-icon" href="/assets/logo-512.png"/>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
    body {font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .book-card img { transition: transform .3s ease }
    .book-card:hover img { transform: scale(1.02) }
    .skeleton { background: linear-gradient(90deg, rgba(0,0,0,.06), rgba(0,0,0,.12), rgba(0,0,0,.06)); background-size: 200% 100%; animation: shimmer 1.2s infinite }
    @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
  
    img{image-rendering:auto}
    @media (min-resolution: 2dppx){.book-card img{filter:none}}
  </style>
  <!-- Optional: set your API key here; page works without a key for most cases -->
  <script>window.GBOOKS_API_KEY = window.GBOOKS_API_KEY || "";</script>
</head>
<body data-active="eBooks" class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100">

  <div id="header-slot"></div>

  <!-- Hero -->
  <section class="relative overflow-hidden bg-gradient-to-br from-amber-50 via-orange-50 to-rose-50 dark:from-gray-800 dark:via-gray-900 dark:to-black">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
      <div>
        <span class="inline-block bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200 text-xs font-semibold px-3 py-1 rounded-full mb-3">Google Books Live Catalog</span>
        <h1 class="text-4xl md:text-5xl font-extrabold leading-tight mb-4">eBooks by Guillaume Lessard</h1>
        <p class="text-lg md:text-xl text-gray-700 dark:text-gray-300">Pulled directly from Google Books. Clean, fast, always up to date.</p>
        <div class="mt-6 flex flex-wrap gap-3">
          <a href="/store.html" class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white">Visit the Store</a>
          <a href="/contact.html" class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">Request bulk or licensing</a>
        </div>
      </div>
      <div class="relative">
        <div class="rounded-2xl overflow-hidden shadow-2xl ring-1 ring-black/5">
          <img src="/assets/img/brand/ebooks_og.jpg" alt="iD01t eBooks" class="w-full h-auto object-cover">
        </div>
      </div>
    </div>
  </section>

  <!-- Controls -->
  <section class="py-6 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row items-center gap-4">
      <input id="search" type="search" placeholder="Search titles, tags, year..." class="w-full md:flex-1 px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900" />
      <select id="filterLang" class="px-3 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900">
        <option value="">All languages</option>
      </select>
      <select id="filterTag" class="px-3 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900">
        <option value="">All categories</option>
      </select>
      <select id="sortBy" class="px-3 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900">
        <option value="newest">Newest first</option>
        <option value="alpha">A → Z</option>
      </select>
    </div>
  </section>

  <!-- Grid -->
  <section class="py-10 bg-gray-50 dark:bg-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div id="status" class="text-sm text-gray-500 dark:text-gray-400 mb-4">Loading catalog from Google Books…</div>
      <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        <div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div><div class="rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow p-4"><div class="skeleton h-48 w-full rounded-lg mb-4"></div><div class="skeleton h-5 w-3/4 rounded mb-2"></div><div class="skeleton h-4 w-1/2 rounded"></div></div>
      </div>
      <div id="empty" class="hidden text-center text-gray-500 dark:text-gray-400 mt-8">No results.</div>
    </div>
  </section>

  <!-- CTA -->
  <section class="py-10 bg-blue-600 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h3 class="text-2xl font-bold mb-2">Want custom editions or bulk licenses?</h3>
      <p class="opacity-90 mb-4">We create tailored versions for teams, schools, and platforms.</p>
      <a href="/contact.html" class="px-6 py-3 rounded-lg bg-white/10 hover:bg-white/20">Contact iD01t Productions</a>
    </div>
  </section>

  <div id="footer-slot"></div>

  <!-- JSON-LD (populated after load) -->
  <script id="ld-catalog" type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"ItemList",
    "name":"iD01t eBooks Catalog",
    "itemListElement":[]
  }
  </script>

  <!-- Google Books-only loader -->
  <script>
  const grid = document.getElementById('grid');
  const empty = document.getElementById('empty');
  const statusEl = document.getElementById('status');
  const $ = (id) => document.getElementById(id);

  const QUERIES = [
    'inauthor:"Guillaume Lessard"',
    'inpublisher:"iD01t Productions"',
    'inauthor:"El\'Nox Rah"',
    'inauthor:"DJ iD01t"'
  ];

  const API = 'https://www.googleapis.com/books/v1/volumes';

  
  function coverUrlById(id, zoom) {
    if (!id) return '';
    const z = Math.max(1, Math.min(5, zoom||3));
    return `https://books.google.com/books/content?id=${id}&printsec=frontcover&img=1&zoom=${z}&source=gbs_api`;
  }

  function imgBest(v) {
    // Prefer constructing from the volume ID at higher zooms (HD)
    const id = v.id || (v.selfLink ? v.selfLink.split('/').pop() : '');
    const primary = id ? coverUrlById(id, 3) : '';
    const retina = id ? coverUrlById(id, 4) : '';
    // Fallback to API-provided links (force https + higher zoom where possible)
    const L = (v.volumeInfo && v.volumeInfo.imageLinks) ? v.volumeInfo.imageLinks : {};
    let fallback = L.extraLarge || L.large || L.medium || L.small || L.thumbnail || L.smallThumbnail || '';
    if (fallback) {
      fallback = fallback.replace(/^http:/, 'https:');
      fallback = fallback.replace(/zoom=\d/, 'zoom=3');
    }
    const src = primary || fallback || '/assets/img/brand/ebooks_og.jpg';
    const src2x = retina || (fallback ? fallback.replace(/zoom=3/, 'zoom=4') : '');
    return { src, src2x };
  }

    let src = L.large || L.medium || L.small || L.thumbnail || L.smallThumbnail || '';
    if (!src) return '/assets/img/brand/ebooks_og.jpg';
    src = src.replace(/^http:/, 'https:');
    if (src.includes('zoom=1')) src = src.replace('zoom=1','zoom=2');
    return src;
  }

  
  function bookFromVolume(v) {
    const vi = v.volumeInfo || {}
    const si = v.saleInfo || {}
    const img = imgBest(v);
    return {
      id: v.id,
      title: vi.title || '',
      subtitle: vi.subtitle || '',
      cover: img.src,
      cover2x: img.src2x,
      year: (vi.publishedDate||'').slice(0,4),
      lang: (vi.language||'').toUpperCase(),
      tags: vi.categories || [],
      authors: vi.authors || [],
      link: vi.infoLink || vi.canonicalVolumeLink || v.selfLink || '',
      buy: si.buyLink || vi.infoLink || '',
    };
  }

    const si = v.saleInfo || {}
    return {
      id: v.id,
      title: vi.title || '',
      subtitle: vi.subtitle || '',
      cover: imgBest(v),
      year: (vi.publishedDate||'').slice(0,4),
      lang: (vi.language||'').toUpperCase(),
      tags: vi.categories || [],
      authors: vi.authors || [],
      link: vi.infoLink || vi.canonicalVolumeLink || v.selfLink || '',
      buy: si.buyLink || vi.infoLink || '',
    };
  }

  
  function cardHTML(b) {
    const tags = (b.tags||[]).slice(0,4).map(t=>`<span class="px-2 py-0.5 rounded-full text-xs bg-gray-100 dark:bg-gray-800">${t}</span>`).join(' ');
    const year = b.year ? `<span class="text-xs text-gray-500 dark:text-gray-400"> • ${b.year}</span>` : '';
    const lang = b.lang ? `<span class="text-xs bg-gray-100 dark:bg-gray-800 rounded px-2 py-0.5">${b.lang}</span>` : '';
    const srcset = b.cover2x ? `${b.cover} 1x, ${b.cover2x} 2x` : `${b.cover} 1x`;
    return `
    <article class="book-card rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-800 bg-white/60 dark:bg-white/5 shadow">
      <img loading="lazy" decoding="async" src="${b.cover}" srcset="${srcset}"
           sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 25vw"
           alt="${b.title} cover" class="w-full aspect-[3/4] object-cover"/>
      <div class="p-4 space-y-3">
        <h3 class="text-lg font-semibold">${b.title}</h3>
        <p class="text-sm text-gray-600 dark:text-gray-400">${b.subtitle||''}</p>
        <div class="flex items-center gap-2">${lang}${year}</div>
        <div class="flex gap-1 flex-wrap">${tags}</div>
        <div class="flex gap-2 flex-wrap mt-2">
          <a href="${b.link}" target="_blank" rel="noopener" class="px-3 py-2 rounded-md border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">Google Books</a>
          ${ b.buy ? `<a href="${b.buy}" target="_blank" rel="noopener" class="px-3 py-2 rounded-md border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800">Buy</a>` : ''}
        </div>
      </div>
    </article>`;
  }

        </div>
      </div>
    </article>`;
  }

  function render(list) {
    if (!list.length) { empty.classList.remove('hidden'); grid.innerHTML=''; return; }
    empty.classList.add('hidden');
    grid.innerHTML = list.map(cardHTML).join('');
  }

  function applyFilters(src) {
    const text = $('search').value.toLowerCase().trim();
    const lang = $('filterLang').value;
    const tag = $('filterTag').value;
    const sortBy = $('sortBy').value;
    let out = src.filter(b => {
      const inText = !text || [b.title,b.subtitle,(b.tags||[]).join(' '),String(b.year||'')].join(' ').toLowerCase().includes(text);
      const inLang = !lang || b.lang === lang;
      const inTag = !tag || (b.tags||[]).includes(tag);
      return inText && inLang && inTag;
    });
    if (sortBy === 'alpha') out.sort((a,b)=> a.title.localeCompare(b.title));
    else out.sort((a,b)=> (b.year||0)-(a.year||0));
    return out;
  }

  let CATALOG = [];

  async function fetchAll(query) {
    const key = window.GBOOKS_API_KEY ? `&key=${encodeURIComponent(window.GBOOKS_API_KEY)}` : '';
    const maxResults = 40;
    let startIndex = 0, total = 0, out = [];
    for (let page=0; page<6; page++) { // up to 240 items/query
      const url = `${API}?q=${encodeURIComponent(query)}&printType=books&maxResults=${maxResults}&startIndex=${startIndex}${key}`;
      const res = await fetch(url);
      if (!res.ok) break;
      const data = await res.json();
      total = data.totalItems || 0;
      const items = (data.items||[]);
      if (!items.length) break;
      out.push(...items);
      startIndex += maxResults;
      if (startIndex >= total) break;
    }
    return out;
  }

  async function loadCatalog() {
    statusEl.textContent = 'Loading catalog from Google Books…';
    const maps = new Map();
    for (const q of QUERIES) {
      try {
        const vols = await fetchAll(q);
        vols.forEach(v => {
          const b = bookFromVolume(v);
          if (!b.title) return;
          const key = (b.title + '|' + (b.year||'')).toLowerCase();
          if (!maps.has(key)) maps.set(key, b);
        });
      } catch(e) { console.warn('Query failed', q, e); }
    }
    CATALOG = Array.from(maps.values());
    // Populate filters dynamically
    const langs = Array.from(new Set(CATALOG.map(b=>b.lang).filter(Boolean))).sort();
    const tags = Array.from(new Set(CATALOG.flatMap(b=>b.tags||[]))).sort();
    $('filterLang').innerHTML = '<option value="">All languages</option>' + langs.map(l=>`<option>${l}</option>`).join('');
    $('filterTag').innerHTML = '<option value="">All categories</option>' + tags.map(t=>`<option>${t}</option>`).join('');
    // Render
    render(applyFilters(CATALOG));
    statusEl.textContent = `Loaded ${CATALOG.length} book(s) from Google Books`;
    // Update JSON-LD
    const ld = document.getElementById('ld-catalog');
    const items = CATALOG.slice(0, 100).map((b,i)=>({
      "@type":"ListItem","position":i+1,"item":{"@type":"Book","name":b.title,"image":b.cover,"url":b.link}
    }));
    ld.textContent = JSON.stringify({"@context":"https://schema.org","@type":"ItemList","name":"iD01t eBooks Catalog","itemListElement":items});
  }

  function refresh() { render(applyFilters(CATALOG)); }
  ['search','filterLang','filterTag','sortBy'].forEach(id => $(id).addEventListener('input', refresh));

  loadCatalog();
  </script>

<script>
// Inject header/footer from /index.html so index is the single source of truth
(async function injectLayout(){
  try{
    const res = await fetch('/index.html', {cache:'no-store'});
    const text = await res.text();
    const doc = new DOMParser().parseFromString(text, 'text/html');

    // Copy any global stylesheets from index <head> if missing
    const head = document.querySelector('head');
    doc.querySelectorAll('link[rel="stylesheet"]').forEach(link => {
      const href = link.getAttribute('href');
      if (href && !document.querySelector('link[rel="stylesheet"][href="' + href + '"]')) {
        const l = document.createElement('link');
        l.rel = 'stylesheet'; l.href = href;
        head.appendChild(l);
      }
    });

    // Inject header and footer HTML
    const header = doc.querySelector('header');
    const footer = doc.querySelector('footer');
    if(header) document.getElementById('header-slot').innerHTML = header.outerHTML;
    if(footer) document.getElementById('footer-slot').innerHTML = footer.outerHTML;

    // Re-execute any scripts inside injected nodes (if index bundled logic there)
    function runScripts(rootId){
      const root = document.getElementById(rootId);
      if(!root) return;
      const scripts = root.querySelectorAll('script');
      scripts.forEach(s => {
        const ns = document.createElement('script');
        Array.from(s.attributes).forEach(a=>ns.setAttribute(a.name,a.value));
        ns.textContent = s.textContent;
        s.replaceWith(ns);
      });
    }
    runScripts('header-slot');
    runScripts('footer-slot');

    // Mark active nav based on current path or data-active
    const active = (document.body.dataset.active || '').toLowerCase();
    const navLinks = document.querySelectorAll('header nav a, #site-header nav a');
    navLinks.forEach(a => {
      a.removeAttribute('aria-current');
      const label = a.textContent.trim().toLowerCase();
      const href = a.getAttribute('href');
      if ((active && label === active.toLowerCase()) ||
          href === location.pathname ||
          (active && href.toLowerCase().includes(active))) {
        a.setAttribute('aria-current','page');
      }
    });
  }catch(e){
    console.warn('Header/Footer injection failed', e);
  }
})();
</script>

</body>
</html>
